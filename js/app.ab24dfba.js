(function(e){function t(t){for(var n,o,s=t[0],c=t[1],l=t[2],d=0,h=[];d<s.length;d++)o=s[d],Object.prototype.hasOwnProperty.call(r,o)&&r[o]&&h.push(r[o][0]),r[o]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(e[n]=c[n]);u&&u(t);while(h.length)h.shift()();return i.push.apply(i,l||[]),a()}function a(){for(var e,t=0;t<i.length;t++){for(var a=i[t],n=!0,s=1;s<a.length;s++){var c=a[s];0!==r[c]&&(n=!1)}n&&(i.splice(t--,1),e=o(o.s=a[0]))}return e}var n={},r={app:0},i=[];function o(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=e,o.c=n,o.d=function(e,t,a){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)o.d(a,n,function(t){return e[t]}.bind(null,n));return a},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/vue/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var l=0;l<s.length;l++)t(s[l]);var u=c;i.push([1,"chunk-vendors"]),a()})({0:function(e,t){},1:function(e,t,a){e.exports=a("cd49")},"13d1":function(e,t,a){},2:function(e,t){},3:function(e,t){},3839:function(e,t,a){"use strict";a("c663")},"3c12":function(e,t,a){"use strict";a("9d33")},4:function(e,t){},"4b46":function(e,t,a){},5:function(e,t){},5298:function(e,t,a){},"5ef4":function(e,t,a){"use strict";a("df3f")},6:function(e,t){},"6b51":function(e,t,a){"use strict";a("9064")},"6e68":function(e,t,a){"use strict";a("e1e5")},"8bb9":function(e,t,a){},"8d2d":function(e,t,a){},9064:function(e,t,a){},9224:function(e){e.exports=JSON.parse('{"name":"open-tree-hole","version":"0.8.1","private":true,"scripts":{"serve":"vue-cli-service serve","build":"vue-cli-service build --mode production","build-report":"vue-cli-service build --mode production --report","lint":"vue-cli-service lint"},"dependencies":{"@mdi/font":"^6.4.95","@types/animejs":"^3.1.4","@types/katex":"^0.11.1","@types/lodash-es":"^4.17.5","@types/marked":"^3.0.2","@types/overlayscrollbars":"^1.12.1","animejs":"^3.2.1","axios":"^0.21.1","core-js":"^3.6.5","github-markdown-css":"^5.0.0","gsap":"^3.8.0","highlight.js":"^11.3.1","katex":"^0.13.20","lodash-es":"^4.17.21","marked":"^3.0.8","overlayscrollbars":"^1.13.1","overlayscrollbars-vue":"^0.2.2","quill-image-resize-module":"^3.0.0","quill-image-super-solution-module":"^2.0.0","register-service-worker":"^1.7.1","v-viewer":"^1.5.1","vconsole":"^3.9.5","vditor":"^3.8.4","vue":"^2.6.11","vue-cookies":"^1.7.4","vue-router":"^3.2.0","vuetify":"^2.4.0","vuex":"^3.6.2"},"devDependencies":{"@typescript-eslint/eslint-plugin":"^4.18.0","@typescript-eslint/parser":"^4.18.0","@vue/cli-plugin-babel":"~4.5.0","@vue/cli-plugin-eslint":"~4.5.0","@vue/cli-plugin-pwa":"~4.5.0","@vue/cli-plugin-router":"~4.5.0","@vue/cli-plugin-typescript":"~4.5.0","@vue/cli-plugin-vuex":"~4.5.0","@vue/cli-service":"^4.5.13","@vue/eslint-config-standard":"^5.1.2","@vue/eslint-config-typescript":"^7.0.0","babel-eslint":"^10.1.0","eslint":"^6.7.2","eslint-plugin-import":"^2.20.2","eslint-plugin-node":"^11.1.0","eslint-plugin-promise":"^4.2.1","eslint-plugin-standard":"^4.0.0","eslint-plugin-vue":"^6.2.2","sass":"^1.32.0","sass-loader":"^10.0.0","typescript":"~4.1.5","vue-class-component":"^7.2.3","vue-cli-plugin-vuetify":"~2.1.0","vue-pdf":"^4.3.0","vue-property-decorator":"^9.1.2","vue-template-compiler":"^2.6.11","vuetify-loader":"^1.7.0","vuex-module-decorators":"^1.0.1"},"eslintConfig":{"root":true,"env":{"node":true},"extends":["plugin:vue/essential","@vue/standard","@vue/typescript"],"parserOptions":{"parser":"@typescript-eslint/parser"}},"browserslist":["> 1%","last 2 versions","not dead"],"gitHooks":{},"license":"MIT","lint-staged":{"*.{js,jsx,vue}":["vue-cli-service lint","git add"]}}')},"9d33":function(e,t,a){},a416:function(e,t,a){"use strict";a("4b46")},c663:function(e,t,a){},c913:function(e,t,a){"use strict";a("13d1")},cb0a:function(e,t,a){},cd49:function(e,t,a){"use strict";a.r(t),a.d(t,"Main",(function(){return Uo}));a("e260"),a("e6cf"),a("cca6"),a("a79d"),a("4de4"),a("d3b7"),a("ac1f"),a("5319");var n=a("2b0e"),r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-app",[a("message",{ref:"message"}),a("Navbar"),a("v-main",[e.hasToken?a("keep-alive",{attrs:{include:"Division"}},[a("router-view",{key:e.$route.fullPath+(e.$route.params.id||"")+e.$route.query})],1):a("router-view",{key:e.$route.fullPath+(e.$route.params.id||"")+e.$route.query})],1)],1)},i=[],o=a("d4ec"),s=a("bee2"),c=a("262e"),l=a("2caf"),u=a("9ab4"),d=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"navbar"},[a("v-app-bar",{attrs:{app:"","elevate-on-scroll":"",dark:"",color:"primary",dense:"",flat:""}},[e.inBanMenuRoutes?e._e():a("v-app-bar-nav-icon",{attrs:{icon:""},on:{click:function(t){t.stopPropagation(),e.showSidebar=!e.showSidebar}}}),e.inAllowBackRoutes?a("v-app-bar-nav-icon",{attrs:{icon:""},on:{click:function(t){return t.stopPropagation(),e.back.apply(null,arguments)}}},[a("v-icon",[e._v("mdi-arrow-left")])],1):e._e(),a("v-app-bar-title",[e._v("FDU Hole")]),a("v-spacer"),a("notifications-menu")],1),a("v-navigation-drawer",{attrs:{app:""},model:{value:e.showSidebar,callback:function(t){e.showSidebar=t},expression:"showSidebar"}},[a("div",{staticClass:"iphone-fitter"}),a("v-list-item",{attrs:{color:"primary"}},[a("v-list-item-content",[a("v-list-item-title",[e._v("FDU Hole")]),a("v-list-item-subtitle",[e._v("欢迎回来")])],1)],1),a("v-divider"),a("v-list",{attrs:{nav:"",dense:""}},[a("v-list-item-group",{attrs:{color:"primary"}},[e._l(e.$feConfig.navItems,(function(t){return[t.group?a("app-navbar-list-group",{key:t.route,attrs:{route:t.route},scopedSlots:e._u([{key:"activator",fn:function(){return[a("v-list-item-icon",[a("v-icon",{domProps:{textContent:e._s(t.icon)}})],1),a("v-list-item-title",[e._v(e._s(t.title))])]},proxy:!0}],null,!0)},e._l(e.groupNavItem.get(t.route),(function(n){return a("v-list-item",{key:t.route+n.route,class:t.route+n.route===e.$route.fullPath?e.activeClass:"",attrs:{disabled:t.route+n.route===e.$route.fullPath},on:{click:function(a){return a.stopPropagation(),e.$router.replace(t.route+n.route)}}},[a("v-list-item-content",[a("v-list-item-title",{domProps:{textContent:e._s(n.name)}})],1)],1)})),1):a("v-list-item",{key:t.route,class:t.route===e.$route.path?e.activeClass:"",attrs:{disabled:t.route===e.$route.path},on:{click:function(a){return a.stopPropagation(),e.$router.replace(t.route)}}},[a("v-list-item-icon",[a("v-icon",{domProps:{textContent:e._s(t.icon)}})],1),a("v-list-item-content",[a("v-list-item-title",{domProps:{textContent:e._s(t.title)}})],1)],1)]}))],2)],1),a("v-divider"),a("v-list",{staticStyle:{padding:"5px"}},[e.filtedTagMap&&e.filtedTagMap[e.$route.path]?a("v-list-item",[a("TagChip",{key:"filtedTag-"+e.filtedTagMap[e.$route.path].tagId,attrs:{tag:e.filtedTagMap[e.$route.path],remove:!0}})],1):e._e(),a("v-list-item",[a("v-form",[a("v-row",[a("v-text-field",{attrs:{type:"search",placeholder:"搜索"},model:{value:e.searchText,callback:function(t){e.searchText=t},expression:"searchText"}}),a("v-list-item-icon",[a("v-btn",{attrs:{type:"submit",icon:"",disabled:0===e.searchText.length},on:{click:e.search}},[a("v-icon",[e._v("mdi-magnify")])],1)],1)],1)],1)],1),a("v-list-item",[a("v-form",[a("v-row",[a("v-text-field",{attrs:{placeholder:"电梯直达"},model:{value:e.holeToGo,callback:function(t){e.holeToGo=t},expression:"holeToGo"}}),a("v-list-item-icon",[a("v-btn",{attrs:{type:"submit",icon:"",disabled:0===e.holeToGo.length},on:{click:e.gotoHole}},[a("v-icon",[e._v("mdi-elevator")])],1)],1)],1)],1)],1)],1),a("div",{staticClass:"drawer-bottom-container"},[a("v-btn",{attrs:{fab:"",fixed:"",bottom:"",color:"primary"},on:{mousedown:function(e){e.preventDefault()},click:e.reload}},[e._v(" 重载 ")])],1)],1)],1)},h=[],p=a("b85c"),v=(a("4ec9"),a("3ca3"),a("ddb0"),a("159b"),a("25f0"),a("b0c0"),a("1b40")),f=a("6fc5"),m=a("2f62");n["default"].use(m["a"]);var g=new m["a"].Store({}),b=function(e){Object(c["a"])(a,e);var t=Object(l["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.apply(this,arguments),e.message=null,e}return Object(s["a"])(a,[{key:"setMessageComponent",value:function(e){this.message=e}},{key:"messageError",value:function(e){this.message&&this.message.error(e)}},{key:"messageSuccess",value:function(e){this.message&&this.message.success(e)}},{key:"messageWarning",value:function(e){this.message&&this.message.warning(e)}},{key:"messageInfo",value:function(e){this.message&&this.message.info(e)}}]),a}(f["d"]);Object(u["a"])([f["c"]],b.prototype,"setMessageComponent",null),Object(u["a"])([Object(f["a"])({rawError:!0})],b.prototype,"messageError",null),Object(u["a"])([Object(f["a"])({rawError:!0})],b.prototype,"messageSuccess",null),Object(u["a"])([Object(f["a"])({rawError:!0})],b.prototype,"messageWarning",null),Object(u["a"])([Object(f["a"])({rawError:!0})],b.prototype,"messageInfo",null),b=Object(u["a"])([Object(f["b"])({store:g,dynamic:!0,name:"MessageStore",namespaced:!0})],b);var y=Object(f["e"])(b),k=y,w=(a("00b4"),function(e){Object(c["a"])(a,e);var t=Object(l["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.apply(this,arguments),e.isMobile=!1,e}return Object(s["a"])(a,[{key:"setIsMobile",value:function(e){this.isMobile=e}},{key:"checkDevice",value:function(){this.setIsMobile(document.body.clientWidth<=768||/^((?!chrome|android).)*safari/i.test(navigator.userAgent))}}]),a}(f["d"]));Object(u["a"])([f["c"]],w.prototype,"setIsMobile",null),Object(u["a"])([f["a"]],w.prototype,"checkDevice",null),w=Object(u["a"])([Object(f["b"])({store:g,dynamic:!0,name:"UtilStore",namespaced:!0})],w);var O=Object(f["e"])(w),x=O,j=function(e){Object(c["a"])(a,e);var t=Object(l["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.apply(this,arguments),e.tagMap={},e}return Object(s["a"])(a,[{key:"addTag",value:function(e){n["default"].set(this.tagMap,e.route,e.tag)}},{key:"clearTag",value:function(e){e?n["default"].delete(this.tagMap,e):this.tagMap={}}}]),a}(f["d"]);Object(u["a"])([f["c"]],j.prototype,"addTag",null),Object(u["a"])([f["c"]],j.prototype,"clearTag",null),j=Object(u["a"])([Object(f["b"])({store:g,dynamic:!0,name:"TagStore",namespaced:!0})],j);var C=Object(f["e"])(j),_=C,I=new n["default"],$=function(e){Object(c["a"])(a,e);var t=Object(l["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.apply(this,arguments),e.setMessageComponent=k.setMessageComponent,e.messageError=k.messageError,e.messageSuccess=k.messageSuccess,e.messageInfo=k.messageInfo,e.messageWarning=k.messageWarning,e.checkDevice=x.checkDevice,e.addTag=function(e,t){return _.addTag({route:e,tag:t})},e.clearTag=_.clearTag,e}return Object(s["a"])(a,[{key:"filtedTagMap",get:function(){return _.tagMap}},{key:"isMobile",get:function(){return x.isMobile}},{key:"onPreloaded",value:function(){}},{key:"onWsMessage",value:function(e){}},{key:"created",value:function(){I.$on("preloaded",this.onPreloaded),I.$on("receive-ws-message",this.onWsMessage)}},{key:"activated",value:function(){I.$off("preloaded",this.onPreloaded),I.$off("receive-ws-message",this.onWsMessage),I.$on("preloaded",this.onPreloaded),I.$on("receive-ws-message",this.onWsMessage)}},{key:"deactivated",value:function(){I.$off("preloaded",this.onPreloaded),I.$off("receive-ws-message",this.onWsMessage)}},{key:"destroyed",value:function(){I.$off("preloaded",this.onPreloaded),I.$off("receive-ws-message",this.onWsMessage)}}]),a}(n["default"]);$=Object(u["a"])([v["a"]],$);var S,R,E=$,V=E,T=a("2877"),M=Object(T["a"])(V,S,R,!1,null,null,null),F=M.exports,D=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-chip",{staticClass:"mx-1 my-1",attrs:{color:e.color,outlined:"",small:"",ripple:""},on:{click:e.onClick}},[e._v(" "+e._s(e.tag.name)+" ")])},H=[],L=a("ade3"),A=a("5530"),P=a("1da1"),q=(a("96cf"),a("d81d"),a("b64b"),a("2ef0")),N=a("3b2f"),B=a.n(N),U=[],W=["red","pink","purple","deep-purple","indigo","blue","light-blue","cyan","teal","green","light-green","yellow","amber","orange","deep-orange","brown","blue-grey","grey"],z=function(){var e=Object(P["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){return setTimeout(e,t)})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),G=function(e){var t=new Date(e);return t.toLocaleDateString()+" "+t.toLocaleTimeString()},J=function(e){var t=new Date(e),a=new Date,n=Math.floor((a.getTime()-t.getTime())/1e3);return n<0&&(n=0),n<60?n+"秒前":n<3600?Math.floor(n/60)+"分钟前":n<86400?Math.floor(n/3600)+"小时前":n<604800?Math.floor(n/86400)+"天前":t.getFullYear()===a.getFullYear()?e.substring(5,10):e.substring(0,10)},X=function e(t){return Array.isArray(t)?t.map((function(t){return e(t)})):null!=t&&t.constructor===Object?Object.keys(t).reduce((function(a,n){return Object(A["a"])(Object(A["a"])({},a),{},Object(L["a"])({},Object(q["camelCase"])(n),e(t[n])))}),{}):t},Y=function(e){return e.replace(/\$\$\s([\s\S]+)\s\$\$/g,(function(e,t){return B.a.renderToString(t,{displayMode:!0,macros:U})})).replace(/\$([\s\S]+)\$/g,(function(e,t){return B.a.renderToString(t,{displayMode:!1})}))},K=function(e){if(null===e)return"";if("*"===e[0])return"red";for(var t=0,a=0;a<e.length;a++)t+=e.charCodeAt(a);return t%=W.length,W[t]},Q=function(e,t){var a,n=Object(p["a"])(t);try{for(n.s();!(a=n.n()).done;){var r=a.value;if(!(r in e))return!1}}catch(i){n.e(i)}finally{n.f()}return!0},Z=function(e){Object(c["a"])(a,e);var t=Object(l["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.apply(this,arguments),e.color="red",e}return Object(s["a"])(a,[{key:"onClick",value:function(){!this.prevent&&this.$route.path&&(this.remove?this.clearTag(this.$route.path):this.addTag(this.$route.path,this.tag))}},{key:"created",value:function(){this.color=K(this.tag.name)}}]),a}(F);Object(u["a"])([Object(v["c"])({required:!0,type:Object})],Z.prototype,"tag",void 0),Object(u["a"])([Object(v["c"])({type:Boolean,default:!1})],Z.prototype,"remove",void 0),Object(u["a"])([Object(v["c"])({type:Boolean,default:!1})],Z.prototype,"prevent",void 0),Z=Object(u["a"])([v["a"]],Z);var ee=Z,te=ee,ae=a("6544"),ne=a.n(ae),re=a("cc20"),ie=Object(T["a"])(te,D,H,!1,null,null,null),oe=ie.exports;ne()(ie,{VChip:re["a"]});a("caad"),a("2532");var se=a("0e54"),ce=a.n(se),le=function(){function e(t){Object(o["a"])(this,e),Object.assign(this,t),this.convertHtml()}return Object(s["a"])(e,[{key:"convertHtml",value:function(){this.html=ce()(Y(this.content))}}]),e}(),ue=function(e){Object(c["a"])(a,e);var t=Object(l["a"])(a);function a(){return Object(o["a"])(this,a),t.apply(this,arguments)}return Object(s["a"])(a,[{key:"convertHtml",value:function(){this.html=this.signMention(Y(this.content))}},{key:"signMention",value:function(e){return e=e.replace(/##?\d+/g,(function(e){return'\n\n<p mention="'+e+'"></p>\n\n'})),e=ce()(Y(e)),e=e.replace(/<p mention="##?\d+"><\/p>/g,(function(e){return e.replace("<p",'<div class="replyDiv"').replace("/p>","/div>")})),e}}]),a}(le),de=function e(t){var a=this;Object(o["a"])(this,e),this.markedFloors=[],t.floors.prefetch.forEach((function(e){a.markedFloors.push(new le(e))})),this.divisionId=t.divisionId,this.floors=t.floors,this.firstFloor=new le(t.floors.firstFloor),this.lastFloor=new le(t.floors.lastFloor),this.isFolded=this.firstFloor.fold.length>0,this.isStarred=me.collection.isStarred(t.holeId),this.holeId=t.holeId,this.holeIdStr=this.holeId.toString(),this.timeCreated=t.timeCreated,this.timeUpdated=t.timeUpdated,this.reply=t.reply,this.tags=t.tags,t.tags.forEach((function(e){"*"===e.name.charAt(0)&&(a.isFolded=!0)})),this.styleData={fold:!0,lines:3,displayIt:!this.isFolded}},he=new n["default"],pe=function(){function e(){Object(o["a"])(this,e),this.collectionIds=[],this.updateHoleMap=new Map}return Object(s["a"])(e,[{key:"clearCollection",value:function(){this.collectionIds=[]}},{key:"setCollection",value:function(e){this.collectionIds=e,this.update()}},{key:"update",value:function(){var e,t=Object(p["a"])(this.updateHoleMap.values());try{for(t.s();!(e=t.n()).done;)for(var a=e.value,r=0;r<a.length;r++)a[r].isStarred!==this.isStarred(a[r].holeId)&&n["default"].set(a,r,new de(a[r]))}catch(i){t.e(i)}finally{t.f()}}},{key:"getCollections",value:function(){var e=Object(P["a"])(regeneratorRuntime.mark((function e(){var t,a,n=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,null===(t=he.$axios)||void 0===t?void 0:t.get("/user/favorites");case 3:a=e.sent,this.clearCollection(),a.data.forEach((function(e){!e.floors.first_floor||!e.floors.last_floor||e.reply<0||n.collectionIds.push(e.hole_id)})),this.update(),e.next=12;break;case 9:throw e.prev=9,e.t0=e["catch"](0),new Error(e.t0);case 12:case"end":return e.stop()}}),e,this,[[0,9]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"isStarred",value:function(e){return this.collectionIds.includes(e)}},{key:"registerUpdateHoleArray",value:function(e,t){this.updateHoleMap.set(e,t)}},{key:"unregisterUpdateHoleArray",value:function(e){this.updateHoleMap.delete(e)}}]),e}(),ve=function(e){Object(c["a"])(a,e);var t=Object(l["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.apply(this,arguments),e.collection=new pe,e.divisions=[],e.userProfile=null,e}return Object(s["a"])(a,[{key:"clear",value:function(){this.collection=new pe,this.divisions=[]}},{key:"setDivisions",value:function(e){this.divisions=e}},{key:"setUserProfile",value:function(e){this.userProfile=e}},{key:"requestDivision",value:function(){var e=Object(P["a"])(regeneratorRuntime.mark((function e(){var t,a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,null===(t=he.$axios)||void 0===t?void 0:t.get("/divisions");case 2:a=e.sent,n=X(a.data),this.setDivisions(n);case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"requestUserProfile",value:function(){var e=Object(P["a"])(regeneratorRuntime.mark((function e(){var t,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,null===(t=he.$axios)||void 0===t?void 0:t.get("/users");case 2:a=e.sent,this.setUserProfile(X(a.data));case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}]),a}(f["d"]);Object(u["a"])([f["c"]],ve.prototype,"clear",null),Object(u["a"])([f["c"]],ve.prototype,"setDivisions",null),Object(u["a"])([f["c"]],ve.prototype,"setUserProfile",null),Object(u["a"])([f["a"]],ve.prototype,"requestDivision",null),Object(u["a"])([f["a"]],ve.prototype,"requestUserProfile",null),ve=Object(u["a"])([Object(f["b"])({store:g,dynamic:!0,name:"UserStore",namespaced:!0})],ve);var fe=Object(f["e"])(ve),me=fe,ge=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("app-menu",{key:"notifications-menu",attrs:{"close-on-content-click":!1,"max-width":e.maxWidth,bottom:"","content-class":"overflow-hidden",left:""},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.attrs,r=t.on;return[a("app-tooltip-btn",e._g(e._b({attrs:{text:"通知"},scopedSlots:e._u([{key:"icon",fn:function(){return[a("v-badge",{attrs:{value:e.unread.length,color:"#ED561B",dot:"",left:"",overlap:""}},[a("v-icon",{staticClass:"mx-1",domProps:{textContent:e._s("mdi-bell-"+(0===e.unread.length?"outline":"ring-outline"))}})],1)]},proxy:!0}],null,!0)},"app-tooltip-btn",n,!1),r))]}}]),model:{value:e.menu,callback:function(t){e.menu=t},expression:"menu"}},[a("v-toolbar",{staticClass:"pr-5",attrs:{width:e.maxWidth,flat:"",short:""}},[a("v-btn",{staticClass:"px-2 ml-n1",attrs:{disabled:e.archived?e.unread.length<1:e.read.length<1,small:"",text:""},on:{click:function(t){e.archived=!e.archived}}},[e._v(" View "+e._s(e.archived?"Unread":"Read")+" "+e._s((e.archived?e.unread:e.read).length)+" ")]),a("v-spacer"),e.marked?a("app-tooltip-btn",{attrs:{disabled:e.done,icon:e.marked.icon,text:e.toggleMsg,small:""},on:{click:e.toggleAll}}):e._e()],1),a("v-divider"),a("v-responsive",{ref:"responsive",staticClass:"overflow-y-scroll",attrs:{"max-height":"320"}},[e.done?a("div",{staticClass:"py-8 text-center text-subtitle-1"},[a("div",[e._v("All done")]),a("v-icon",{attrs:{color:"grey lighten-2",size:"96"}},[e._v(" mdi-vuetify ")])],1):e._l(e.filtered,(function(t){return a("v-list-item",{key:t.messageId,attrs:{ripple:!1},on:{click:function(a){return e.select(t)}}},[t.marked&&!e.isMobile?a("notification-floor-card-menu",{attrs:{floor:t.marked},scopedSlots:e._u([{key:"activator",fn:function(n){var r=n.attrs,i=n.on;return[a("v-list-item-content",e._g(e._b({},"v-list-item-content",r,!1),i),[a("div",{staticClass:"grey--text text--darken-1 text-caption font-weight-light text-uppercase",domProps:{textContent:e._s(t.timeCreatedDifference)}}),a("v-list-item-title",{staticClass:"text-subtitle-1",domProps:{textContent:e._s(t.message)}})],1)]}}],null,!0)}):a("v-list-item-content",[a("div",{staticClass:"grey--text text--darken-1 text-caption font-weight-light text-uppercase",domProps:{textContent:e._s(t.timeCreatedDifference)}}),a("v-list-item-title",{staticClass:"text-subtitle-1",domProps:{textContent:e._s(t.message)}})],1),a("v-list-item-action",[a("v-btn",{attrs:{ripple:!1,icon:""},on:{click:function(a){return a.stopPropagation(),a.preventDefault(),e.toggle(t.messageId)}}},[a("v-icon",{domProps:{textContent:e._s(e.marked.icon)}})],1)],1)],1)}))],2)],1)},be=[],ye=a("2909"),ke=(a("4e827"),a("99af"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-menu",e._g(e._b({attrs:{bottom:"","close-delay":"100","content-class":"rounded",left:"","max-height":"500","offset-y":"","open-delay":"60","open-on-hover":"","close-on-click":!1,transition:"slide-y-transition"},scopedSlots:e._u([{key:"activator",fn:function(t){return[e._t("activator",null,null,Object.assign({},t))]}}],null,!0)},"v-menu",e.$attrs,!1),e.$listeners),[a("app-sheet",{attrs:{outlined:!1}},[e._t("default")],2)],1)}),we=[],Oe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-sheet",e._g(e._b({staticClass:"overflow-hidden"},"v-sheet",Object.assign({},{outlined:!0,rounded:!0},e.$attrs),!1),e.$listeners),[e._t("default")],2)},xe=[],je=a("2fe1"),Ce=function(e){Object(c["a"])(a,e);var t=Object(l["a"])(a);function a(){return Object(o["a"])(this,a),t.apply(this,arguments)}return a}(n["default"]);Ce=Object(u["a"])([je["b"]],Ce);var _e=Ce,Ie=_e,$e=a("8dd9"),Se=Object(T["a"])(Ie,Oe,xe,!1,null,null,null),Re=Se.exports;ne()(Se,{VSheet:$e["a"]});var Ee=function(e){Object(c["a"])(a,e);var t=Object(l["a"])(a);function a(){return Object(o["a"])(this,a),t.apply(this,arguments)}return a}(n["default"]);Ee=Object(u["a"])([Object(je["b"])({components:{AppSheet:Re}})],Ee);var Ve=Ee,Te=Ve,Me=a("e449"),Fe=Object(T["a"])(Te,ke,we,!1,null,null,null),De=Fe.exports;ne()(Fe,{VMenu:Me["a"]});var He=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("span",{staticClass:"v-app-tooltip-btn d-inline-block"},[a("v-tooltip",{attrs:{bottom:"","content-class":"v-app-tooltip-btn__content","open-delay":"200"},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on;return[a("v-btn",e._g(e._b({attrs:{"aria-label":e.text,icon:""}},"v-btn",e.$attrs,!1),Object.assign({},n,e.$listeners)),[e.$slots.icon?e._t("icon"):a("v-icon",{domProps:{textContent:e._s(e.icon)}})],2)]}}],null,!0)},[a("span",[e._v(e._s(e.text))])])],1)},Le=[],Ae=function(e){Object(c["a"])(a,e);var t=Object(l["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.apply(this,arguments),e.inheritAttrs=!1,e}return a}(n["default"]);Object(u["a"])([Object(v["c"])({type:String})],Ae.prototype,"icon",void 0),Object(u["a"])([Object(v["c"])({required:!0,type:String})],Ae.prototype,"text",void 0),Ae=Object(u["a"])([v["a"]],Ae);var Pe=Ae,qe=Pe,Ne=(a("6b51"),a("8336")),Be=a("132d"),Ue=a("3a2f"),We=Object(T["a"])(qe,He,Le,!1,null,null,null),ze=We.exports;function Ge(e){var t=["message"];return Q(e,t)}function Je(e){return Ye(e)?new Ke(e):Ge(e)?new Xe(e):null}ne()(We,{VBtn:Ne["a"],VIcon:Be["a"],VTooltip:Ue["a"]});var Xe=function e(t){Object(o["a"])(this,e),Object.assign(this,t)};function Ye(e){var t=["message","messageId","code","data","hasRead","timeCreated"];return Q(e,t)}var Ke=function(e){Object(c["a"])(a,e);var t=Object(l["a"])(a);function a(){return Object(o["a"])(this,a),t.apply(this,arguments)}return a}(Xe),Qe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-menu",{attrs:{"close-on-content-click":!1,"nudge-width":150,"nudge-left":18,"offset-x":"","open-on-hover":"",left:""},scopedSlots:e._u([{key:"activator",fn:function(t){return[e._t("activator",null,null,Object.assign({},t))]}}],null,!0),model:{value:e.menu,callback:function(t){e.menu=t},expression:"menu"}},[a("app-sheet",{attrs:{outlined:!1}},[a("FloorCard",{attrs:{floor:e.floor,"no-action":!0}})],1)],1)},Ze=[],et=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-card",{staticClass:"rounded",attrs:{id:e.index}},[a("v-card-text",{staticClass:"d-flex pb-4 pt-2 text-body-2"},[a("span",{staticClass:"flex-left"},[e._v(" "+e._s(e.floor.anonyname)+" ")]),a("span",{staticClass:"flex-center"},[e._v(" "+e._s(e._f("timeDifference")(e.floor.timeCreated))+" ")]),a("span",{staticClass:"flex-right"},[e.noAction?e._e():[1===e.operations.length?a("v-btn",{staticClass:"grey--text",staticStyle:{"padding-bottom":"-10px"},attrs:{small:"",text:""},on:{click:e.report}},[a("v-icon",[e._v("mdi-alert-outline")]),a("br"),a("span",[e._v("举报")])],1):a("v-menu",{attrs:{"offset-y":""},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,r=t.attrs;return[a("v-btn",e._g(e._b({staticClass:"grey--text",staticStyle:{"padding-bottom":"-10px"},attrs:{small:"",text:""}},"v-btn",r,!1),n),[a("v-icon",[e._v("mdi-dots-horizontal")]),a("br"),a("span",[e._v("更多")])],1)]}}],null,!1,470267379)},[a("v-list",e._l(e.operations,(function(t){return a("v-list-item",{key:"operation-"+t.text},[a("v-btn",{staticClass:"grey--text",staticStyle:{"padding-bottom":"-10px"},attrs:{small:"",text:""},on:{click:t.operation}},[a("v-icon",[e._v("mdi-"+e._s(t.icon))]),a("br"),a("span",[e._v(e._s(t.text))])],1)],1)})),1)],1)]],2)]),a("v-card-text",{staticClass:"py-0"},[a("div",{staticClass:"floor-body markdown-body rich-text text--primary ma-0 text-body-1",attrs:{index:e.index},domProps:{innerHTML:e._s(e.floor.html)}})]),a("v-card-text",{staticClass:"d-flex text-body-2 pb-2"},[a("span",{staticClass:"flex-left",domProps:{innerHTML:e._s(e.idInfo)}}),a("span",{staticClass:"flex-center"},[e.noAction?e._e():a("v-btn",{staticClass:"grey--text",staticStyle:{"padding-bottom":"-10px"},attrs:{small:"",text:""},on:{click:function(t){return e.$emit("reply")}}},[a("v-icon",[e._v("mdi-reply-outline")]),a("br"),a("span",[e._v("回复")])],1)],1),a("span",{staticClass:"flex-right"},[a("v-btn",{staticClass:"grey--text",staticStyle:{"padding-bottom":"-10px"},attrs:{small:"",text:""},on:{click:e.like}},[e.floor.liked?a("v-icon",[e._v("mdi-thumb-up")]):a("v-icon",[e._v("mdi-thumb-up-outline")]),a("br"),a("span",[e._v(e._s(e.floor.like))])],1)],1)])],1)},tt=[],at=(a("a9e3"),function(e){Object(c["a"])(a,e);var t=Object(l["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.apply(this,arguments),e.operations=[],e}return Object(s["a"])(a,[{key:"idInfo",get:function(){return-1===this.index?"<b>##".concat(this.floor.floorId,"</b>"):"<b>".concat(this.index,"L</b>(##").concat(this.floor.floorId,")")}},{key:"setOperation",value:function(){var e,t=this,a={icon:"alert-outline",text:"举报",operation:this.report},n={icon:"close-box-outline",text:"删除本层",operation:function(){return t.removeFloor(!1)}},r={icon:"close-box-outline",text:"删除本层",operation:function(){return t.removeFloor(!0)}},i={icon:"pencil-outline",text:"编辑",operation:function(){return t.$emit("edit")}},o={icon:"close-outline",text:"处罚",operation:this.penalty};this.floor instanceof ue&&this.floor.isMe?this.operations=[n,i]:null!==(e=me.userProfile)&&void 0!==e&&e.isAdmin?this.operations=[r,i,o]:this.operations=[a]}},{key:"floorChanged",value:function(){this.setOperation()}},{key:"penalty",value:function(){var e=prompt("输入惩罚等级");if(null!=e){var t=parseInt(e);(isNaN(t)||t<0||t>3)&&this.messageError("非有效惩罚等级！（惩罚应为0,1,2或3）"),this.$axios.post("/penalty/".concat(this.floor.floorId))}}},{key:"like",value:function(){var e=Object(P["a"])(regeneratorRuntime.mark((function e(){var t,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.floor instanceof ue){e.next=2;break}return e.abrupt("return");case 2:return this.floor.liked?n["default"].set(this.floor,"like",this.floor.like-1):this.floor.like++,t={like:this.floor.liked?"cancel":"add"},n["default"].set(this.floor,"liked",!this.floor.liked),e.prev=5,e.next=8,this.$axios.put("/floors/".concat(this.floor.floorId),t);case 8:a=e.sent,a.data.liked?this.messageSuccess("点赞成功"):this.messageSuccess("取消点赞成功"),e.next=16;break;case 12:e.prev=12,e.t0=e["catch"](5),console.log(e.t0),e.t0.response&&e.t0.response.data.message?this.messageError(e.t0.response.data.message):e.t0.status?this.messageError("未知错误，状态码："+e.t0.status):this.messageError(e.t0);case 16:case"end":return e.stop()}}),e,this,[[5,12]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"removeFloor",value:function(){var e=Object(P["a"])(regeneratorRuntime.mark((function e(t){var a,n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a="",!t){e.next=5;break}if(a=prompt("输入删除理由"),a){e.next=5;break}return e.abrupt("return");case 5:return n={},a&&(n.delete_reason=a),e.prev=7,e.next=10,this.$axios.delete("/floors/".concat(this.floor.floorId),n);case 10:r=e.sent,200===r.status?this.messageSuccess("删除成功"):this.messageError(r.data.message),e.next=17;break;case 14:e.prev=14,e.t0=e["catch"](7),e.t0.response?403===e.t0.response.status?this.messageError("没有权限删除"):this.messageError(e.t0.response.data.message):this.messageError(e.t0);case 17:case"end":return e.stop()}}),e,this,[[7,14]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"report",value:function(){var e=Object(P["a"])(regeneratorRuntime.mark((function e(){var t,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=prompt("输入举报理由"),""===t&&this.messageError("举报理由不能为空！"),e.prev=2,e.next=5,this.$axios.post("/reports",{floor_id:this.floor.floorId,reason:t});case 5:a=e.sent,200===a.status&&this.messageSuccess("举报成功"),e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](2),this.messageError(e.t0.response.data.message);case 12:case"end":return e.stop()}}),e,this,[[2,9]])})));function t(){return e.apply(this,arguments)}return t}()}]),a}(F));Object(u["a"])([Object(v["c"])({required:!0,type:Object})],at.prototype,"floor",void 0),Object(u["a"])([Object(v["c"])({required:!1,type:Number,default:-1})],at.prototype,"index",void 0),Object(u["a"])([Object(v["c"])({required:!1,type:Boolean,default:!1})],at.prototype,"noAction",void 0),Object(u["a"])([Object(v["e"])("floor",{immediate:!0})],at.prototype,"floorChanged",null),at=Object(u["a"])([v["a"]],at);var nt=at,rt=nt,it=a("b0af"),ot=a("99d9"),st=a("8860"),ct=a("da13"),lt=Object(T["a"])(rt,et,tt,!1,null,"b1cb0d44",null),ut=lt.exports;ne()(lt,{VBtn:Ne["a"],VCard:it["a"],VCardText:ot["c"],VIcon:Be["a"],VList:st["a"],VListItem:ct["a"],VMenu:Me["a"]});var dt=function(e){Object(c["a"])(a,e);var t=Object(l["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.apply(this,arguments),e.menu=!1,e}return a}(n["default"]);Object(u["a"])([Object(v["c"])({required:!0})],dt.prototype,"floor",void 0),dt=Object(u["a"])([Object(v["a"])({components:{FloorCard:ut,AppSheet:Re}})],dt);var ht=dt,pt=ht,vt=Object(T["a"])(pt,Qe,Ze,!1,null,null,null),ft=vt.exports;ne()(vt,{VMenu:Me["a"]});a("a630"),a("7db0"),a("a434"),a("1e25");var mt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-card",{staticClass:"reply mx-0 mb-2",class:e.additionalClass},[a("v-card-actions",{staticClass:"pb-0 pl-4 pr-4 pt-2 text-body-2"},[a("span",{staticStyle:{color:"rgba(85,93,86,0.48)"}},[a("b",[e._v(e._s(e.mentionFloor.anonyname))]),e._v(" "+e._s(e.mentionFloorInfo)+" ")]),a("v-spacer"),e.gotoMentionFloor?a("v-icon",{attrs:{small:""},on:{click:e.gotoMentionFloor}},[e._v(" "+e._s(e.gotoMentionFloorIcon)+" ")]):e.cancel?a("v-icon",{attrs:{small:""},on:{click:e.cancel}},[e._v(" mdi-close ")]):e._e()],1),a("v-card-text",{staticClass:"reply-text pt-2 pb-2",class:e.clipClass,domProps:{innerHTML:e._s(e.mentionFloor.html)}}),e.needClip?a("v-btn",{staticClass:"btn-fixed-br",attrs:{text:"",block:"",depressed:"","x-small":"",color:"grey lighten-1"},on:{click:function(t){e.isClipped=!e.isClipped}}},[a("v-spacer"),e.isClipped?a("v-icon",[e._v("mdi-chevron-double-down")]):a("v-icon",[e._v("mdi-chevron-double-up")])],1):e._e()],1)},gt=[],bt=a("1020"),yt=a.n(bt),kt=function(e){Object(c["a"])(a,e);var t=Object(l["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.apply(this,arguments),e.maxHeight=200,e.needClip=!1,e.isClipped=!1,e}return Object(s["a"])(a,[{key:"clipClass",get:function(){return this.isClipped?" reply-clip":""}},{key:"mounted",value:function(){if(yt.a.highlightAll(),this.$el){var e=parseInt(window.getComputedStyle(this.$el).height);e>this.maxHeight&&(this.needClip=!0,this.isClipped=!0)}}}]),a}(F);Object(u["a"])([Object(v["c"])({required:!0})],kt.prototype,"mentionFloor",void 0),Object(u["a"])([Object(v["c"])({type:Function})],kt.prototype,"gotoMentionFloor",void 0),Object(u["a"])([Object(v["c"])({type:String,default:"mdi-arrow-collapse-up"})],kt.prototype,"gotoMentionFloorIcon",void 0),Object(u["a"])([Object(v["c"])({type:String,default:""})],kt.prototype,"mentionFloorInfo",void 0),Object(u["a"])([Object(v["c"])({type:String,default:""})],kt.prototype,"additionalClass",void 0),Object(u["a"])([Object(v["c"])({type:Function})],kt.prototype,"cancel",void 0),kt=Object(u["a"])([v["a"]],kt);var wt=kt,Ot=wt,xt=(a("fae0"),a("2fa4")),jt=Object(T["a"])(Ot,mt,gt,!1,null,"08f6b5df",null),Ct=jt.exports;ne()(jt,{VBtn:Ne["a"],VCard:it["a"],VCardActions:ot["a"],VCardText:ot["c"],VIcon:Be["a"],VSpacer:xt["a"]});var _t=a("f309"),It=a("fcf4");n["default"].use(_t["a"]);var $t=new _t["a"]({theme:{themes:{light:{primary:It["a"].blue},dark:{primary:It["a"].blueGrey}}}});function St(e,t){return Rt.apply(this,arguments)}function Rt(){return Rt=Object(P["a"])(regeneratorRuntime.mark((function e(t,a){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!("mention"in t)||0===t.mention.length){e.next=4;break}return e.next=3,n["default"].nextTick();case 3:Tt(t,a);case 4:case"end":return e.stop()}}),e)}))),Rt.apply(this,arguments)}var Et=function(e){I.$emit("scroll-to-floor",e)};function Vt(e,t){var a,n=new Map,r=e.sort((function(e){return"#"===e[1]?1:0})),i=Array.from(t),o=Object(p["a"])(r);try{var s=function(){var e=a.value,t=void 0;if(t="#"===e[1]?i.find((function(t){return t.floorId===parseInt(e.substring(2))})):i.find((function(t){return t.holeId===parseInt(e.substring(1))})),!t)return"continue";var r=i.indexOf(t);i.splice(r,1),n.set(e,new le(t))};for(o.s();!(a=o.n()).done;)s()}catch(c){o.e(c)}finally{o.f()}return n}function Tt(e,t){var a,n=null!==(a=null===t||void 0===t?void 0:t.getIndex(e.floorId))&&void 0!==a?a:-1,r=document.querySelectorAll('div[index="'+n+'"] > div.replyDiv'),i=[];r.forEach((function(e){if(!e.innerHTML){var t=e.getAttribute("mention");t&&i.push(t)}}));for(var o=Vt(i,e.mention),s=function(a){var i;if(r[a].innerHTML)return"continue";var s=r[a].getAttribute("mention");if(!s)return"continue";var c=o.get(s);if(!c)return"continue";var l=void 0,u=null!==(i=null===t||void 0===t?void 0:t.getIndex(c.floorId))&&void 0!==i?i:-1;l=-1!==u?function(){Et(u)}:-1!==n?function(){Mt(e,c)}:function(){Ft(e.holeId,e.floorId)};var d="";r[a].parentElement&&r[a].parentElement.firstChild!==r[a]&&(d+="mt-3 "),r[a].parentElement&&r[a].parentElement.lastChild!==r[a]&&(d+="mb-3 "),d=d.trimEnd(),new Ct({propsData:{mentionFloor:c,gotoMentionFloor:l,gotoMentionFloorIcon:"mdi-arrow-collapse-up",mentionFloorInfo:-1===u?"#"+c.floorId:u.toString()+"L",additionalClass:d},vuetify:$t}).$mount(r[a])},c=0;c<r.length;c++)s(c)}function Mt(e,t){x.isMobile?Ft(t.holeId,t.floorId):I.$emit("goto-mention-floor",e,t)}function Ft(e,t,a){var n="number"===typeof e?e:e.holeId;x.isMobile?void 0!==t?Uo.$router.push({path:"/hole/".concat(n),query:{mention:t.toString()}}):Uo.$router.push({path:"/hole/".concat(n)}):void 0===t?I.$emit("goto-hole",e):void 0===a?I.$emit("goto-hole",e,t):I.$emit("goto-hole",e,t,a)}function Dt(e,t,a){return Ht.apply(this,arguments)}function Ht(){return Ht=Object(P["a"])(regeneratorRuntime.mark((function e(t,a,n){var r,i,o,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!x.isMobile){e.next=4;break}Ft(t,a,n),e.next=15;break;case 4:return e.next=6,null===(r=he.$axios)||void 0===r?void 0:r.get("/holes/".concat(t));case 6:if(i=e.sent,o=new de(X(i.data)),s="/division/".concat(o.divisionId),Uo.$route.path===s){e.next=14;break}return e.next=12,Uo.$router.push(s);case 12:return e.next=14,z(500);case 14:Ft(o,a,n);case 15:case"end":return e.stop()}}),e)}))),Ht.apply(this,arguments)}var Lt=function(e){Object(c["a"])(a,e);var t=Object(l["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.apply(this,arguments),e.archived=!1,e.icons={read:"mdi-email-open",unread:"mdi-email-mark-as-unread"},e.menu=!1,e.readRaw=[],e.unreadRaw=[],e}return Object(s["a"])(a,[{key:"read",get:function(){return this.readRaw.map((function(e){if(!("floorId"in e.data))return Object(A["a"])(Object(A["a"])({},e),{},{timeCreatedDifference:J(e.timeCreated)});var t=new ue(e.data);return St(t),Object(A["a"])(Object(A["a"])({},e),{},{timeCreatedDifference:J(e.timeCreated),marked:t})}))}},{key:"unread",get:function(){return this.unreadRaw.map((function(e){if(!("floorId"in e.data))return Object(A["a"])(Object(A["a"])({},e),{},{timeCreatedDifference:J(e.timeCreated)});var t=new ue(e.data);return St(t),Object(A["a"])(Object(A["a"])({},e),{},{timeCreatedDifference:J(e.timeCreated),marked:t})}))}},{key:"done",get:function(){return 0===this.filtered.length}},{key:"filtered",get:function(){return this.archived?this.read:this.unread}},{key:"marked",get:function(){var e=this.archived?"unread":"read",t=this.icons[e];return t&&e?{icon:t}:null}},{key:"maxWidth",get:function(){return this.isMobile?296:450}},{key:"toggleMsg",get:function(){return this.archived?"标记为未读":"标记为已读"}},{key:"select",value:function(e){Dt(e.data.holeId,e.data.floorId),this.toggle(e.messageId),this.menu=!1}},{key:"toggle",value:function(e){this.$ws.sendAction({action:this.archived?"unread":"read",id:e});var t=this.readRaw.concat(this.unreadRaw).sort((function(e,t){return t.messageId-e.messageId}));t.forEach((function(t){t.messageId===e&&(t.hasRead=!t.hasRead)})),this.readRaw=t.filter((function(e){return e.hasRead})),this.unreadRaw=t.filter((function(e){return!e.hasRead}))}},{key:"toggleAll",value:function(){var e=this;this.archived?this.readRaw.forEach((function(t){e.$ws.sendAction({action:"unread",id:t.messageId})})):this.$ws.sendAction({action:"clear"});var t=this.readRaw.concat(this.unreadRaw).sort((function(e,t){return t.messageId-e.messageId}));this.readRaw=this.unreadRaw=[],this.archived?this.unreadRaw=t:this.readRaw=t}},{key:"onWsMessage",value:function(e){if(e instanceof Ke){for(var t=this.readRaw.concat(this.unreadRaw),a=!1,n=0;n<t.length;n++)if(t[n].messageId===e.messageId){t[n]=e,a=!0;break}a||(t=[].concat(Object(ye["a"])(t),[e])),t=t.sort((function(e,t){return t.messageId-e.messageId})),this.readRaw=t.filter((function(e){return e.hasRead})),this.unreadRaw=t.filter((function(e){return!e.hasRead}))}}}]),a}(F);Object(u["a"])([Object(v["d"])()],Lt.prototype,"responsive",void 0),Lt=Object(u["a"])([Object(v["a"])({components:{NotificationFloorCardMenu:ft,AppMenu:De,AppTooltipBtn:ze}})],Lt);var At=Lt,Pt=At,qt=a("4ca6"),Nt=a("ce7e"),Bt=a("1800"),Ut=a("5d23"),Wt=a("6b53"),zt=a("71d9"),Gt=Object(T["a"])(Pt,ge,be,!1,null,null,null),Jt=Gt.exports;ne()(Gt,{VBadge:qt["a"],VBtn:Ne["a"],VDivider:Nt["a"],VIcon:Be["a"],VListItem:ct["a"],VListItemAction:Bt["a"],VListItemContent:Ut["a"],VListItemTitle:Ut["c"],VResponsive:Wt["a"],VSpacer:xt["a"],VToolbar:zt["a"]});var Xt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-list-group",{ref:"group",attrs:{"no-action":"",color:"primary "+(e.$vuetify.theme.dark?"lighten-1":"darken-2")},scopedSlots:e._u([{key:"activator",fn:function(){return[e._t("activator")]},proxy:!0}],null,!0)},[e._t("default")],2)},Yt=[],Kt=function(e){Object(c["a"])(a,e);var t=Object(l["a"])(a);function a(){return Object(o["a"])(this,a),t.apply(this,arguments)}return Object(s["a"])(a,[{key:"activate",value:function(e){this.group.isActive=e}},{key:"routeChanged",value:function(){var e=Object(P["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$nextTick();case 2:this.activate(this.$route.path.includes(this.route));case 3:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"mounted",value:function(){var e=Object(P["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$nextTick();case 2:return e.next=4,this.$nextTick();case 4:this.activate(this.$route.path.includes(this.route));case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}]),a}(n["default"]);Object(u["a"])([Object(v["d"])()],Kt.prototype,"group",void 0),Object(u["a"])([Object(v["c"])({required:!0,type:String})],Kt.prototype,"route",void 0),Object(u["a"])([Object(v["e"])("$route")],Kt.prototype,"routeChanged",null),Kt=Object(u["a"])([v["a"]],Kt);var Qt=Kt,Zt=Qt,ea=a("56b0"),ta=Object(T["a"])(Zt,Xt,Yt,!1,null,"645911b4",null),aa=ta.exports;ne()(ta,{VListGroup:ea["a"]});var na=function(e){Object(c["a"])(a,e);var t=Object(l["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.apply(this,arguments),e.isDarkTheme=!1,e.searchText="",e.showSidebar=!e.isMobile,e.currentPage=0,e.inAllowBackRoutes=!1,e.inBanMenuRoutes=!0,e.holeToGo="",e.groupNavItem=new Map,e}return Object(s["a"])(a,[{key:"activeClass",get:function(){return{"v-list-item--active":!0,"white--text":this.$vuetify.theme.dark}}},{key:"search",value:function(){"search"!==this.$route.path&&this.$router.push({name:"search",query:{wd:this.searchText}}),I.$emit("search",this.searchText),this.searchText=""}},{key:"reload",value:function(){location.reload()}},{key:"gotoHole",value:function(){var e="#"===this.holeToGo.charAt(0)?parseInt(this.holeToGo.substring(1)):parseInt(this.holeToGo);Dt(e),this.holeToGo=""}},{key:"onPreloaded",value:function(){var e=[];me.divisions.forEach((function(t){e.push({route:"/"+t.divisionId.toString(),name:t.name})})),this.groupNavItem=new Map(this.groupNavItem.set("/division",e))}},{key:"back",value:function(){this.$router.back()}},{key:"mounted",value:function(){this.$nextTick(this.checkDevice),this.showSidebar=!this.isMobile}},{key:"isDarkThemeChange",value:function(){this.$vuetify.theme.dark=this.isDarkTheme,console.log("%c [切换主题] 当前主题 %c ".concat(this.$vuetify.theme.dark?"dark":"light"," %c"),"background:#35495e ; padding: 1px; border-radius: 3px 0 0 3px;  color: #fff","background:#41b883 ; padding: 1px; border-radius: 0 3px 3px 0;  color: #fff","background:transparent")}},{key:"routeChange",value:function(){var e=this;this.isDarkTheme=matchMedia("(prefers-color-scheme: dark)").matches,matchMedia("(prefers-color-scheme: dark)").addEventListener("change",(function(t){e.isDarkTheme=t.matches})),this.inAllowBackRoutes=function(){var t,a,n=e.$router.currentRoute.name,r=Object(p["a"])(e.$feConfig.allowBackRoutes);try{for(r.s();!(a=r.n()).done;)if(t=a.value,n===t)return!0}catch(i){r.e(i)}finally{r.f()}return!1}(),this.inBanMenuRoutes=function(){var t,a,n=e.$router.currentRoute.name,r=Object(p["a"])(e.$feConfig.banMenuRoutes);try{for(r.s();!(a=r.n()).done;)if(t=a.value,n===t)return!0}catch(i){r.e(i)}finally{r.f()}return!1}()}}]),a}(F);Object(u["a"])([Object(v["e"])("isDarkTheme")],na.prototype,"isDarkThemeChange",null),Object(u["a"])([Object(v["e"])("$route",{immediate:!0})],na.prototype,"routeChange",null),na=Object(u["a"])([Object(v["a"])({components:{AppNavbarListGroup:aa,NotificationsMenu:Jt,TagChip:oe}})],na);var ra=na,ia=ra,oa=(a("e630"),a("40dc")),sa=a("5bc1"),ca=a("bb78"),la=a("4bd4"),ua=a("1baa"),da=a("34c3"),ha=a("f774"),pa=a("0fd9"),va=a("8654"),fa=Object(T["a"])(ia,d,h,!1,null,"6f70dd9e",null),ma=fa.exports;ne()(fa,{VAppBar:oa["a"],VAppBarNavIcon:sa["a"],VAppBarTitle:ca["a"],VBtn:Ne["a"],VDivider:Nt["a"],VForm:la["a"],VIcon:Be["a"],VList:st["a"],VListItem:ct["a"],VListItemContent:Ut["a"],VListItemGroup:ua["a"],VListItemIcon:da["a"],VListItemSubtitle:Ut["b"],VListItemTitle:Ut["c"],VNavigationDrawer:ha["a"],VRow:pa["a"],VSpacer:xt["a"],VTextField:va["a"]});var ga=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-snackbar",{attrs:{top:"",color:e.type,timeout:e.timeout},model:{value:e.isAlert,callback:function(t){e.isAlert=t},expression:"isAlert"}},[a("v-icon",{attrs:{left:""}},[e._v(" "+e._s(e.icon)+" ")]),e._v(" "+e._s(e.message)+" ")],1)],1)},ba=[],ya=function(e){Object(c["a"])(a,e);var t=Object(l["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.apply(this,arguments),e.isAlert=!1,e.type="info",e.message="",e.icon="",e.timeout="2000",e}return Object(s["a"])(a,[{key:"mounted",value:function(){this.setMessageComponent(this)}},{key:"alert",value:function(){var e=this;this.isAlert?(this.isAlert=!1,this.$nextTick((function(){e.isAlert=!0}))):this.isAlert=!0}},{key:"success",value:function(e){this.type="success",this.message=e,this.icon="mdi-check-circle-outline",this.alert()}},{key:"info",value:function(e){this.type="info",this.message=e,this.icon="mdi-alert-circle-outline",this.alert()}},{key:"warning",value:function(e){this.type="warning",this.message=e,this.icon="mdi-alert-outline",this.alert()}},{key:"error",value:function(e){this.type="error",this.message=e,this.icon="mdi-alert-octagram-outline",this.alert()}}]),a}(F);ya=Object(u["a"])([v["a"]],ya);var ka=ya,wa=ka,Oa=a("2db4"),xa=Object(T["a"])(wa,ga,ba,!1,null,null,null),ja=xa.exports;ne()(xa,{VIcon:Be["a"],VSnackbar:Oa["a"]});a("5298"),a("e4cb"),a("be0f"),a("2c43"),a("52b6");var Ca=function(e){Object(c["a"])(a,e);var t=Object(l["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.apply(this,arguments),e._token=localStorage.getItem("token")||"",e._email=localStorage.getItem("email")||"",e._newcomer=localStorage.getItem("newcomer")||"",e}return Object(s["a"])(a,[{key:"token",get:function(){return this._token}},{key:"tokenNoPrefix",get:function(){var e;return null===(e=this._token)||void 0===e?void 0:e.substring(6)}},{key:"email",get:function(){return this._email}},{key:"newcomer",get:function(){return this._newcomer}},{key:"setToken",value:function(e){this._token=e,localStorage.setItem("token",e)}},{key:"setEmail",value:function(e){this._email=e,localStorage.setItem("email",e)}},{key:"setNewcomer",value:function(e){this._newcomer=e,localStorage.setItem("newcomer",e)}},{key:"clear",value:function(){localStorage.clear(),this._token="",this._email="",this._newcomer=""}}]),a}(f["d"]);Object(u["a"])([f["c"]],Ca.prototype,"setToken",null),Object(u["a"])([f["c"]],Ca.prototype,"setEmail",null),Object(u["a"])([f["c"]],Ca.prototype,"setNewcomer",null),Object(u["a"])([f["c"]],Ca.prototype,"clear",null),Ca=Object(u["a"])([Object(f["b"])({store:g,dynamic:!0,name:"LocalStorageStore",namespaced:!0})],Ca);var _a=Object(f["e"])(Ca),Ia=_a;a("3a34");var $a=function(e){Object(c["a"])(a,e);var t=Object(l["a"])(a);function a(){return Object(o["a"])(this,a),t.apply(this,arguments)}return Object(s["a"])(a,[{key:"hasToken",get:function(){return!!Ia.token}},{key:"created",value:function(){var e=this;document.addEventListener("onlined",(function(t){e.messageSuccess(t.detail)})),document.addEventListener("offlined",(function(t){e.messageWarning(t.detail)}))}}]),a}(F);$a=Object(u["a"])([Object(v["a"])({components:{Navbar:ma,Message:ja}})],$a);var Sa=$a,Ra=Sa,Ea=a("7496"),Va=a("f6c4"),Ta=Object(T["a"])(Ra,r,i,!1,null,null,null),Ma=Ta.exports;ne()(Ta,{VApp:Ea["a"],VMain:Va["a"]});var Fa=a("9483");Object(Fa["a"])("".concat("/vue/","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered:function(){console.log("Service worker has been registered."),navigator.serviceWorker.addEventListener("message",(function(e){"success"===e.data.status&&document.dispatchEvent(new CustomEvent("onlined",{detail:e.data.msg})),"warning"===e.data.status&&document.dispatchEvent(new CustomEvent("offlined",{detail:e.data.msg}))}))},cached:function(){console.log("Content has been cached for offline use.")},updatefound:function(){console.log("New content is downloading.")},updated:function(){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(e){console.error("Error during service worker registration:",e)}});var Da=a("8c4f"),Ha=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{attrs:{"fill-height":""}},[a("v-row",{attrs:{align:"center",justify:"center"}},[a("v-col",{staticClass:"text-center",attrs:{cols:"10",sm:"8",md:"6",lg:"4"}},[a("v-card",{staticClass:"py-8",attrs:{elevation:"4"}},[a("h1",[e._v("登录")]),a("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[a("div",{staticClass:"pl-7 pr-10"},[a("v-text-field",{attrs:{label:"edu邮箱","prepend-icon":"mdi-email",clearable:!e.valid,counter:32,"error-messages":e.errorMsg.email,rules:e.notEmptyRules},model:{value:e.email,callback:function(t){e.email=t},expression:"email"}}),a("v-text-field",{attrs:{label:"密码","prepend-icon":"mdi-lock",type:"password",clearable:!e.valid,counter:32,rules:e.passwordRules},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.login.apply(null,arguments)}},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1),a("div",{staticClass:"px-10"},[a("v-btn",{staticClass:"my-4",attrs:{color:"primary",block:"",disabled:!e.valid},on:{click:e.login}},[e._v(" 登录 ")])],1),a("div",[a("v-btn",{attrs:{text:"",color:"primary",href:"#/license"}},[e._v(" 登录意味着你同意这些协议 ")])],1),a("div",[a("v-btn",{attrs:{text:"",color:"primary",href:"#/register"}},[e._v(" 没有账号？点此注册 ")])],1),a("div",[a("v-btn",{attrs:{text:"",color:"primary",href:"#/forgetpassword"}},[e._v(" 忘记密码 ")])],1)])],1)],1)],1)],1)},La=[],Aa=function(e){Object(c["a"])(a,e);var t=Object(l["a"])(a);function a(){return Object(o["a"])(this,a),t.apply(this,arguments)}return Object(s["a"])(a,[{key:"preload",value:function(){var e=Object(P["a"])(regeneratorRuntime.mark((function e(){var t,a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(Ia.token){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,this.$ws.isConnecting()||this.$ws.isConnected()||this.$ws.connect(),t=me.requestDivision,a=me.requestUserProfile,n=[t(),a()],e.next=9,Promise.all(n);case 9:I.$emit("preloaded"),e.next=16;break;case 12:e.prev=12,e.t0=e["catch"](2),console.log(e.t0),this.messageError(e.t0);case 16:case"end":return e.stop()}}),e,this,[[2,12]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"created",value:function(){this.preload()}}]),a}(F);Aa=Object(u["a"])([v["a"]],Aa);var Pa,qa,Na=Aa,Ba=Na,Ua=Object(T["a"])(Ba,Pa,qa,!1,null,null,null),Wa=Ua.exports,za=a("85b1"),Ga=function(e){Object(c["a"])(a,e);var t=Object(l["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.apply(this,arguments),e.alert=!1,e.valid=!0,e.email="",e.password="",e.notEmptyRules=[function(e){return!!e||"内容不能为空"}],e.passwordRules=[function(e){return!!e||"密码不能为空"},function(e){return e.length<=32||"密码不能超过32字符"},function(e){return e.length>=8||"密码不能少于8字符"}],e.errorMsg={email:""},e}return Object(s["a"])(a,[{key:"login",value:function(){var e=Object(P["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.$refs.form.validate(),e.prev=1,e.next=4,this.$axios.post("login",{email:this.email,password:this.password});case 4:if(t=e.sent,"登录成功！"!==t.data.message){e.next=13;break}return this.messageSuccess(t.data.message),Ia.setToken("token "+t.data.token),Ia.setEmail(this.email),e.next=11,this.$router.replace("/division/1");case 11:e.next=15;break;case 13:this.valid=!1,this.messageError(t.data.message);case 15:e.next=21;break;case 17:e.prev=17,e.t0=e["catch"](1),this.valid=!1,this.messageError("用户名或密码错误");case 21:case"end":return e.stop()}}),e,this,[[1,17]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"checkEmail",value:function(){/^[0-9]{11}@(m\.)?fudan\.edu\.cn$/.test(this.email)?this.errorMsg.email="":this.errorMsg.email="@fudan.edu.cn"}},{key:"emailChanged",value:function(){this.debouncedCheckEmail()}},{key:"created",value:function(){this.debouncedCheckEmail=Object(za["a"])(this.checkEmail,500)}}]),a}(Wa);Object(u["a"])([Object(v["e"])("email")],Ga.prototype,"emailChanged",null),Ga=Object(u["a"])([v["a"]],Ga);var Ja=Ga,Xa=Ja,Ya=a("62ad"),Ka=a("a523"),Qa=Object(T["a"])(Xa,Ha,La,!1,null,null,null),Za=Qa.exports;ne()(Qa,{VBtn:Ne["a"],VCard:it["a"],VCol:Ya["a"],VContainer:Ka["a"],VForm:la["a"],VRow:pa["a"],VTextField:va["a"]});var en=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{attrs:{"fill-height":""}},[a("v-row",{attrs:{align:"center",justify:"center"}},[a("v-col",{staticClass:"text-center",attrs:{cols:"12",sm:"8",md:"6",lg:"4"}},[a("v-card",{staticClass:"py-8",attrs:{elevation:"4"}},[a("div",{staticClass:"text-h4 pb-2"},[e._v("欢迎注册")]),a("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[a("v-alert",{staticClass:"my-4",attrs:{transition:"slide-y-transition",type:e.alertType,value:e.isAlert}},[e._v(" "+e._s(e.alertMsg)+" ")]),a("div",{staticClass:"pl-7 pr-10"},[a("v-text-field",{attrs:{label:"edu邮箱","prepend-icon":"mdi-email","error-messages":e.errorMsg["email"],clearable:!e.valid,counter:32,rules:e.notEmptyRules},model:{value:e.email,callback:function(t){e.email=t},expression:"email"}}),a("v-row",{staticStyle:{"margin-bottom":"-12px"},attrs:{align:"center",justify:"center"}},[a("v-col",{attrs:{cols:"6",sm:"8"}},[a("v-text-field",{attrs:{label:"邮件验证码","prepend-icon":"mdi-email-check","error-messages":e.errorMsg["code"],clearable:!e.valid,counter:6,rules:e.codeRules},model:{value:e.code,callback:function(t){e.code=t},expression:"code"}})],1),a("v-col",{attrs:{cols:"6",sm:"4"}},[a("v-btn",{attrs:{color:"primary",block:"",disabled:!e.sendValid},on:{click:e.sendCode}},[e._v(" "+e._s(e.sendButton)+" ")])],1)],1),a("v-text-field",{attrs:{label:"密码",type:"password","prepend-icon":"mdi-lock",clearable:!e.valid,counter:32,rules:e.passwordRules},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}}),a("v-text-field",{attrs:{label:"重复密码",type:"password","prepend-icon":"mdi-lock","error-messages":e.errorMsg["password"],clearable:!e.valid,counter:32,rules:e.passwordRules},model:{value:e.password2,callback:function(t){e.password2=t},expression:"password2"}}),a("v-row",{staticStyle:{"margin-bottom":"-12px"},attrs:{align:"center",justify:"center"}},[a("v-checkbox",{attrs:{label:"同意"},model:{value:e.agreelicenses,callback:function(t){e.agreelicenses=t},expression:"agreelicenses"}}),a("a",{attrs:{href:"/#/license",target:"_blank"}},[e._v("相关协议")])],1)],1),a("div",{staticClass:"px-10"},[a("v-btn",{staticClass:"my-4",attrs:{color:"success",block:"",disabled:!(e.agreelicenses&&e.valid)},on:{click:e.register}},[e._v("注册 ")])],1)],1)],1)],1)],1)],1)},tn=[],an=function(e){Object(c["a"])(a,e);var t=Object(l["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.apply(this,arguments),e.agreelicenses=!1,e.password="",e.password2="",e.email="",e.code="",e.sendButton="发送验证码",e.sendValid=!0,e.valid=!0,e.isAlert=!1,e.alertMsg="",e.alertType="info",e.errorMsg={email:"",password:""},e.notEmptyRules=[function(e){return!!e||"内容不能为空"}],e.codeRules=[function(e){return!!e||"内容不能为空"},function(e){return/^[0-9]{6}$/.test(e)||"验证码格式不对"}],e.passwordRules=[function(e){return!!e||"内容不能为空"},function(e){return e.length<=32||"密码不能超过32字符"},function(e){return e.length>=8||"密码不能少于8字符"}],e}return Object(s["a"])(a,[{key:"checkEmail",value:function(){/^[0-9]{11}@(m\.)?fudan\.edu\.cn$/.test(this.email)?this.errorMsg.email="":this.errorMsg.email="@fudan.edu.cn"}},{key:"checkPassword",value:function(){this.password!==this.password2?this.errorMsg.password="两次输入不一致":this.errorMsg.password=""}},{key:"sendCode",value:function(){var e=Object(P["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.email){e.next=3;break}return this.messageError("用户名与邮箱不能为空"),e.abrupt("return");case 3:return this.sendButtonChangeStatus().then(),this.messageInfo("验证码已发送, 请检查邮件以继续"),e.next=7,this.$axios.get("/verify/email",{params:{email:this.email}});case 7:t=e.sent,"邮箱不在白名单内！"===t.data.message?this.messageError(t.data.message):this.messageSuccess(t.data.message);case 9:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"sendButtonChangeStatus",value:function(){var e=Object(P["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.sendValid=!1,t=60;case 2:if(!(t>=0)){e.next=9;break}return this.sendButton=t.toString(),e.next=6,z(1e3);case 6:t--,e.next=2;break;case 9:this.sendButton="发送验证码",this.sendValid=!0;case 11:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"register",value:function(){var e=Object(P["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!this.form.validate()){e.next=17;break}return e.prev=1,e.next=4,this.$axios.post("/register",{email:this.email,password:this.password,verification:parseInt(this.code)});case 4:return t=e.sent,this.messageSuccess("注册成功！"),Ia.setNewcomer("true"),Ia.setToken("token "+t.data.token),e.next=10,z(1e3);case 10:return e.next=12,this.$router.replace("/division/1");case 12:e.next=17;break;case 14:e.prev=14,e.t0=e["catch"](1),this.messageError(e.t0.response.data.message);case 17:case"end":return e.stop()}}),e,this,[[1,14]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"emailChanged",value:function(){this.debouncedCheckEmail()}},{key:"password2Changed",value:function(){this.debouncedCheckPassword()}},{key:"created",value:function(){this.debouncedCheckEmail=Object(za["a"])(this.checkEmail,1e3),this.debouncedCheckPassword=Object(za["a"])(this.checkPassword,500)}}]),a}(Wa);Object(u["a"])([Object(v["d"])()],an.prototype,"form",void 0),Object(u["a"])([Object(v["e"])("email")],an.prototype,"emailChanged",null),Object(u["a"])([Object(v["e"])("password2")],an.prototype,"password2Changed",null),an=Object(u["a"])([v["a"]],an);var nn=an,rn=nn,on=a("0798"),sn=a("ac7c"),cn=Object(T["a"])(rn,en,tn,!1,null,null,null),ln=cn.exports;ne()(cn,{VAlert:on["a"],VBtn:Ne["a"],VCard:it["a"],VCheckbox:sn["a"],VCol:Ya["a"],VContainer:Ka["a"],VForm:la["a"],VRow:pa["a"],VTextField:va["a"]});var un=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-row",{attrs:{justify:"center"}},[a("v-col",{attrs:{cols:"12",md:"9"}},[a("FloorList",{attrs:{"wrapped-hole-or-id":e.computedDiscussionId,"display-floor-id":e.mentionFloorId}})],1)],1)],1)},dn=[],hn=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",["hole"!==this.$route.name||this.initiating?e._e():a("v-card",{staticClass:"mt-n2 mx-n2 mb-3",attrs:{"max-width":"700px"}},[a("v-card-text",{staticClass:"text--primary pb-2 pt-2 font-weight-medium"},e._l(e.hole.tags,(function(t,n){return a("v-chip",{key:n,staticClass:"ma-1",attrs:{color:"red",outlined:"",ripple:""}},[e._v(" "+e._s(t.name)+" ")])})),1),a("v-divider"),a("v-card-text",{staticClass:"text--primary pt-2 pb-2 text-center"},[a("span",{staticStyle:{float:"left"}},[e._v("#"+e._s(e.hole.holeId))]),a("span",{staticStyle:{float:"inherit"}},[e._v(e._s(e._f("timeDifference")(e.hole.timeUpdated)))]),a("span",{staticStyle:{float:"right"}},[e._v(" "+e._s(e.hole.reply)+" "),a("v-icon",{attrs:{small:""}},[e._v("mdi-message-processing-outline")])],1)])],1),a("transition-group",{attrs:{name:"slide-fade"}},e._l(e.floors,(function(t,n){return a("v-row",{directives:[{name:"viewer",rawName:"v-viewer"}],key:""+n,attrs:{justify:"center"}},[a("v-col",{class:e.colClass},[a("FloorCard",{attrs:{floor:t,index:n},on:{reply:function(a){return e.reply(t.floorId)},edit:function(a){return e.edit(t.floorId)}}})],1)],1)})),1),e.initiating?e._e():a("div",{staticClass:"float-btn"},[a("v-dialog",{attrs:{persistent:"","max-width":e.editorWidth},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,r=t.attrs;return[a("v-btn",e._g(e._b({attrs:{fab:"",color:"secondary"},on:{mousedown:function(e){e.preventDefault()}}},"v-btn",r,!1),n),[a("v-icon",[e._v("mdi-send")])],1)]}}],null,!1,925447242),model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("v-card",[a("v-card-title",[a("span",{staticClass:"headline"},[e._v("发表回复")])]),a("v-card-text",[e.replyFloor?a("Mention",{attrs:{"mention-floor":e.replyFloor,cancel:e.removeReplyFloor}}):e._e(),a("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[a("editor",{ref:"editor",attrs:{contentName:e.contentName},on:{error:e.editorError}})],1)],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"primary",text:""},on:{click:e.closeDialog}},[e._v(" 关闭")]),"reply"===e.operation||"add"===e.operation?a("v-btn",{attrs:{color:"primary",text:"",disabled:!e.valid},on:{click:e.addFloor}},[e._v(" 发送 ")]):"edit"===e.operation?a("v-btn",{attrs:{color:"primary",text:"",disabled:!e.valid},on:{click:e.editFloor}},[e._v(" 修改 ")]):e._e()],1)],1)],1),a("br"),a("v-btn",{attrs:{fab:"",color:"secondary"},on:{mousedown:function(e){e.preventDefault()},click:e.changeCollectionStatus}},[a("v-icon",{class:e.hole.isStarred?"v-icon--starred":""},[e._v("mdi-star")])],1)],1),a("loading",{ref:"loading",attrs:{request:[e.getFloors],"pause-loading":e.initiating}})],1)},pn=[],vn=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-row",{directives:[{name:"intersect",rawName:"v-intersect",value:{handler:e.onIntersect,options:{threshold:[0,.2]}},expression:"{\n    handler: onIntersect,\n    options: { threshold: [0,0.2] }\n  }"}],staticClass:"py-4"},[a("v-col",{staticClass:"text-center"},[a("v-progress-linear",{attrs:{active:e.isLoading||e.pauseLoading,indeterminate:"",absolute:"",top:"",color:"teal"}}),e.isLoading||e.pauseLoading?a("div",[a("v-progress-circular",{attrs:{indeterminate:"",color:"teal"}})],1):e._e(),e.hasNext||e.isLoading||e.pauseLoading?e._e():a("div",[e._v("没有然后了......")])],1)],1)},fn=[],mn=(a("e9c4"),function(e){Object(c["a"])(a,e);var t=Object(l["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.apply(this,arguments),e.hasNext=!0,e.isLoading=!1,e}return Object(s["a"])(a,[{key:"onIntersect",value:function(e){var t=this;e[0].isIntersecting&&this.load().catch((function(e){console.log(e),void 0===e.response?t.messageError(JSON.stringify(e)):t.messageError(e.response.data.message)}))}},{key:"load",value:function(){var e=Object(P["a"])(regeneratorRuntime.mark((function e(){var t,a=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=a.length>0&&void 0!==a[0]?a[0]:0,this.hasNext&&!this.pauseLoading&&0!==this.request.length){e.next=3;break}return e.abrupt("return");case 3:return this.isLoading=!0,e.next=6,this.request[t]();case 6:this.hasNext=e.sent,this.isLoading=!1;case 8:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"loadOnce",value:function(){var e=Object(P["a"])(regeneratorRuntime.mark((function e(){var t,a=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=a.length>0&&void 0!==a[0]?a[0]:0,!this.pauseLoading){e.next=4;break}return console.error("Try to load when loading is paused."),e.abrupt("return");case 4:return this.isLoading=!0,e.next=7,this.request[t]();case 7:this.hasNext=e.sent,this.isLoading=!1;case 9:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"loadCustomRequestOnce",value:function(){var e=Object(P["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.waitForUnpause(8);case 2:return this.isLoading=!0,e.next=5,t();case 5:this.isLoading=!1;case 6:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"waitForUnpause",value:function(){var e=Object(P["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!(this.pauseLoading&&t>0)){e.next=5;break}return e.next=3,z(500);case 3:return e.next=5,this.waitForUnpause(t-1);case 5:this.pauseLoading&&console.error("Try to load when loading is paused.");case 6:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"continueLoad",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.isLoading||(this.hasNext=!0,this.load(e))}}]),a}(F));Object(u["a"])([Object(v["c"])({required:!0,type:Array})],mn.prototype,"request",void 0),Object(u["a"])([Object(v["c"])({required:!1,type:Boolean,default:!1})],mn.prototype,"pauseLoading",void 0),mn=Object(u["a"])([v["a"]],mn);var gn=mn,bn=gn,yn=a("490a"),kn=a("8e36"),wn=a("269a"),On=a.n(wn),xn=a("90a2"),jn=Object(T["a"])(bn,vn,fn,!1,null,null,null),Cn=jn.exports;ne()(jn,{VCol:Ya["a"],VProgressCircular:yn["a"],VProgressLinear:kn["a"],VRow:pa["a"]}),On()(jn,{Intersect:xn["a"]});var _n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{attrs:{id:this.contentName,name:"description"}})])},In=[],$n=a("ff41"),Sn=a.n($n),Rn=(a("2f2f"),function(e){Object(c["a"])(a,e);var t=Object(l["a"])(a);function a(){return Object(o["a"])(this,a),t.apply(this,arguments)}return Object(s["a"])(a,[{key:"validate",value:function(){return!!this.getContent()||(this.$emit("error","内容不能为空"),!1)}},{key:"getContent",value:function(){return this.editor.getValue()}},{key:"setContent",value:function(e){this.editor.setValue(e)}},{key:"mounted",value:function(){var e=this,t=Ia.token,a=this.isMobile?["headings","bold","italic","strike","|","line","quote","list","code","|","emoji","link","upload",{name:"more",toolbar:["export","outline","preview","devtools","info","help"]}]:["emoji","headings","bold","italic","strike","link","|","list","ordered-list","check","outdent","indent","|","quote","line","code","inline-code","insert-before","insert-after","|","upload","record","table","|","undo","redo","|","edit-mode","content-theme","code-theme","export",{name:"more",toolbar:["fullscreen","both","preview","info","help"]}];this.editor=new Sn.a(this.contentName,{height:window.innerHeight-220,placeholder:"说些什么......",toolbarConfig:{pin:!1},toolbar:a,icon:"material",cache:{enable:!0},counter:{enable:!0},hint:{},upload:{accept:"image/*",url:this.$feConfig.backEndApi+"images",headers:{Authorization:t||""},multiple:!1,fieldName:"image",linkToImgCallback:function(){console.log("api处理")},success:function(t,a){var n=JSON.parse(a).url;return e.editor.insertValue("![](".concat(n,")")),!0},error:function(t){console.log(t),e.$emit("error",t)}},after:function(){}})}},{key:"created",value:function(){}}]),a}(F));Object(u["a"])([Object(v["c"])({type:String})],Rn.prototype,"contentName",void 0),Rn=Object(u["a"])([v["a"]],Rn);var En=Rn,Vn=En,Tn=Object(T["a"])(Vn,_n,In,!1,null,null,null),Mn=Tn.exports,Fn=function(e){Object(c["a"])(a,e);var t=Object(l["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.apply(this,arguments),e.floors=[],e.replyFloor=null,e.dialog=!1,e.operation="add",e.editingFloorId=0,e.requiredRules=[function(e){return!!e||"内容不能为空"}],e.valid=!0,e}return Object(s["a"])(a,[{key:"computedDiscussionId",get:function(){return-1}},{key:"editorError",value:function(e){this.messageError(e)}},{key:"closeDialog",value:function(){this.dialog=!1,this.replyFloor=null,this.operation="add"}},{key:"refresh",value:function(){this.request.clear(),this.floors=this.request.datas,this.loading.continueLoad()}},{key:"getIndex",value:function(e){for(var t=0;t<this.floors.length;t++)if(this.floors[t].floorId===e)return t;return-1}},{key:"reply",value:function(e){this.replyFloor=this.floors[this.getIndex(e)],this.operation="reply",this.dialog=!0}},{key:"edit",value:function(e){var t=this.floors[this.getIndex(e)];t instanceof ue&&t.mention[0]&&(this.replyFloor=new le(t.mention[0])),this.operation="edit",this.editingFloorId=e,this.dialog=!0}},{key:"removeReplyFloor",value:function(){this.replyFloor=null}},{key:"getHole",value:function(){var e=Object(P["a"])(regeneratorRuntime.mark((function e(t){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.$axios.get("/holes/"+t);case 3:a=e.sent,a.data&&(this.hole=new de(X(a.data))),e.next=10;break;case 7:e.prev=7,e.t0=e["catch"](0),void 0===e.t0.response?this.messageError(JSON.stringify(e.t0)):this.messageError(e.t0.response.data.message);case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"changeCollectionStatus",value:function(){var e=Object(P["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.hole.isStarred=!this.hole.isStarred,e.prev=1,!this.hole.isStarred){e.next=8;break}return e.next=5,this.$axios.delete("/user/favorites",{data:{hole_id:this.hole.holeId}});case 5:t=e.sent,e.next=11;break;case 8:return e.next=10,this.$axios.post("/user/favorites",{hole_id:this.hole.holeId});case 10:t=e.sent;case 11:this.messageSuccess(t.data.message),me.collection.setCollection(t.data.data),e.next=19;break;case 15:e.prev=15,e.t0=e["catch"](1),this.messageError(e.t0.response.data.message),this.hole.isStarred=!this.hole.isStarred;case 19:case"end":return e.stop()}}),e,this,[[1,15]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"getFloors",value:function(){var e=Object(P["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.request){e.next=2;break}return e.abrupt("return",!1);case 2:return t=!1,e.prev=3,e.next=6,this.request.request();case 6:t=e.sent,e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](3),void 0===e.t0.response?this.messageError(JSON.stringify(e.t0)):this.messageError(e.t0.response.data.message);case 12:return e.abrupt("return",t);case 13:case"end":return e.stop()}}),e,this,[[3,9]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"addFloor",value:function(){var e=Object(P["a"])(regeneratorRuntime.mark((function e(){var t,a,n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!this.form.validate()||!this.editor.validate()){e.next=19;break}return this.dialog=!1,t=this.loading,a=this.editor,n=(this.replyFloor?"##"+this.replyFloor.floorId+"\n\n":"")+this.editor.getContent(),e.prev=5,e.next=8,this.$axios.post("/floors",{content:n,hole_id:this.computedDiscussionId});case 8:r=e.sent,this.messageSuccess(r.data.message),t.continueLoad(),this.replyFloor=null,a.setContent(""),e.next=19;break;case 15:e.prev=15,e.t0=e["catch"](5),console.log(e.t0),this.messageError(e.t0);case 19:case"end":return e.stop()}}),e,this,[[5,15]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"editFloor",value:function(){var e=Object(P["a"])(regeneratorRuntime.mark((function e(){var t,a,r,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!this.form.validate()||!this.editor.validate()){e.next=21;break}return this.dialog=!1,t=this.editor,a=(this.replyFloor?"##"+this.replyFloor.floorId+"\n\n":"")+this.editor.getContent(),e.prev=4,e.next=7,this.$axios.put("/floors/".concat(this.editingFloorId),{content:a});case 7:r=e.sent,this.messageSuccess("修改成功"),i=new ue(X(r.data)),this.renderFloor(i).then(),this.checkAndRerenderFloors(i),n["default"].set(this.floors,this.getIndex(i.floorId),i),this.replyFloor=null,t.setContent(""),e.next=21;break;case 17:e.prev=17,e.t0=e["catch"](4),console.log(e.t0),this.messageError(e.t0);case 21:case"end":return e.stop()}}),e,this,[[4,17]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"checkAndRerenderFloors",value:function(e){var t=this;this.floors.forEach((function(a,r){if(a instanceof ue&&0!==a.mention.length){for(var i=!1,o=0;o<a.mention.length;o++)a.mention[o].floorId===e.floorId&&(a.mention[o]=e,i=!0);i&&(a.html+=" ",t.renderFloor(a),n["default"].set(t.floors,r,a))}}))}},{key:"renderFloor",value:function(){var e=Object(P["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,St(t,this);case 2:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"contentName",get:function(){return"discussion-"+this.computedDiscussionId+"-content"}}]),a}(F);Object(u["a"])([Object(v["c"])({type:Number,default:-1})],Fn.prototype,"displayFloorId",void 0),Object(u["a"])([Object(v["d"])()],Fn.prototype,"form",void 0),Object(u["a"])([Object(v["d"])()],Fn.prototype,"editor",void 0),Object(u["a"])([Object(v["d"])()],Fn.prototype,"loading",void 0),Fn=Object(u["a"])([v["a"]],Fn);var Dn,Hn,Ln=Fn,An=Ln,Pn=Object(T["a"])(An,Dn,Hn,!1,null,null,null),qn=Pn.exports,Nn=a("45eb"),Bn=a("7e84"),Un=a("5c8a"),Wn=a("3a59"),zn=function(){function e(){Object(o["a"])(this,e),this.datas=[]}return Object(s["a"])(e,[{key:"clear",value:function(){this.datas=[]}},{key:"pushData",value:function(e){this.datas.push(e)}}]),e}(),Gn=function(e){Object(c["a"])(a,e);var t=Object(l["a"])(a);function a(e){var n;return Object(o["a"])(this,a),n=t.call(this),n.loadedLength=0,n.datas=Object(Un["a"])(e),n}return Object(s["a"])(a,[{key:"clear",value:function(){Object(Nn["a"])(Object(Bn["a"])(a.prototype),"clear",this).call(this),this.loadedLength=0}},{key:"pushData",value:function(e,t,a){void 0===t||t>=this.loadedLength?this.loadedLength===this.datas.length?(this.datas.push(e),this.loadedLength++):a&&a(e,this.datas[this.loadedLength])?n["default"].set(this.datas,this.loadedLength++,e):this.datas[this.loadedLength++]=e:a&&a(e,this.datas[t])?n["default"].set(this.datas,t,e):this.datas[t]=e}}]),a}(zn),Jn=function(e){Object(c["a"])(a,e);var t=Object(l["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.apply(this,arguments),e.tag=null,e.pinCount=0,e}return Object(s["a"])(a,[{key:"requestHole",value:function(){var e=Object(P["a"])(regeneratorRuntime.mark((function e(t){var a,n,r,i,o=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=o.length>1&&void 0!==o[1]?o[1]:0,e.next=3,null===(a=he.$axios)||void 0===a?void 0:a.get("/holes/".concat(t));case 3:r=e.sent,i=new de(X(r.data)),this.datas.splice(n,0,i);case 6:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"pushFront",value:function(e){Object(Wn["a"])(this.datas,(function(t){return t.holeId===e.holeId})),this.datas.splice(0,0,e)}},{key:"pin",value:function(e){this.pushFront(e),this.pinCount++}},{key:"pushData",value:function(e){var t=!1;this.datas.forEach((function(a){a.holeId===e.holeId&&(t=!0)})),t||Object(Nn["a"])(Object(Bn["a"])(a.prototype),"pushData",this).call(this,e)}}]),a}(zn),Xn=function(e){Object(c["a"])(a,e);var t=Object(l["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.apply(this,arguments),e.startTime=new Date,e}return Object(s["a"])(a,[{key:"clear",value:function(){Object(Nn["a"])(Object(Bn["a"])(a.prototype),"clear",this).call(this),this.startTime=new Date}},{key:"request",value:function(){var e=Object(P["a"])(regeneratorRuntime.mark((function e(){var t,a,n,r,i=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a={start_time:this.startTime.toISOString(),length:10,prefetch_length:10,division_id:1},this.tag&&(a.tag=this.tag.name),e.next=4,null===(t=he.$axios)||void 0===t?void 0:t.get("/holes",{params:a});case 4:return n=e.sent,r=!1,n.data.forEach((function(e){if(e.floors.first_floor&&e.floors.last_floor&&!(e.reply<0)){var t=new de(X(e));i.pushData(t),r=!0}})),this.datas.length>0&&(this.startTime=new Date(this.datas[this.datas.length-1].timeUpdated)),e.abrupt("return",r);case 9:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}]),a}(Jn),Yn=function(e){Object(c["a"])(a,e);var t=Object(l["a"])(a);function a(e){var n;return Object(o["a"])(this,a),n=t.call(this),n.startTime=new Date,n.divisionId=e,n}return Object(s["a"])(a,[{key:"clear",value:function(){Object(Nn["a"])(Object(Bn["a"])(a.prototype),"clear",this).call(this),this.startTime=new Date}},{key:"request",value:function(){var e=Object(P["a"])(regeneratorRuntime.mark((function e(){var t,a,n,r,i=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=!1,n={start_time:this.startTime.toISOString(),length:10,prefetch_length:10,division_id:this.divisionId},console.error(this.tag),this.tag&&(n.tag=this.tag.name),e.next=6,null===(t=he.$axios)||void 0===t?void 0:t.get("/holes",{params:n});case 6:return r=e.sent,r.data.forEach((function(e){if(e.floors.first_floor&&e.floors.last_floor&&!(e.reply<0)){var t=new de(X(e));i.pushData(t),a=!0}})),this.datas.length>0&&(this.startTime=new Date(this.datas[this.datas.length-1].timeUpdated)),e.abrupt("return",a);case 10:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}]),a}(Jn),Kn=function(e){Object(c["a"])(a,e);var t=Object(l["a"])(a);function a(){return Object(o["a"])(this,a),t.apply(this,arguments)}return Object(s["a"])(a,[{key:"request",value:function(){var e=Object(P["a"])(regeneratorRuntime.mark((function e(){var t,a,n=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,null===(t=he.$axios)||void 0===t?void 0:t.get("/user/favorites");case 2:return a=e.sent,a.data.forEach((function(e){if(e.floors.first_floor&&e.floors.last_floor&&!(e.reply<0)){var t=new de(X(e));n.pushData(t)}})),e.abrupt("return",!1);case 5:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()}]),a}(Jn),Qn=function(e){Object(c["a"])(a,e);var t=Object(l["a"])(a);function a(e){var n;return Object(o["a"])(this,a),n=t.call(this),n.searchStr=e,n}return Object(s["a"])(a,[{key:"request",value:function(){var e=Object(P["a"])(regeneratorRuntime.mark((function e(){var t,a,n=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,null===(t=he.$axios)||void 0===t?void 0:t.get("/floors",{params:{s:this.searchStr}});case 2:return a=e.sent,a.data.forEach((function(e){var t=new le(X(e));n.pushData(t)})),e.abrupt("return",!1);case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}]),a}(zn),Zn=function(e){Object(c["a"])(a,e);var t=Object(l["a"])(a);function a(e,n,r){var i;return Object(o["a"])(this,a),i=t.call(this,e),i.holeId=n,i.renderFloor=r,i}return Object(s["a"])(a,[{key:"request",value:function(){var e=Object(P["a"])(regeneratorRuntime.mark((function e(){var t,a,n,r,i=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,null===(t=he.$axios)||void 0===t?void 0:t.get("/floors",{params:{hole_id:this.holeId,start_floor:this.loadedLength,length:10}});case 2:return a=e.sent,n=a.config.params.start_floor,r=!1,a.data.forEach((function(e){var t=new ue(X(e));i.renderFloor(t),i.pushData(t,n++,(function(){return!0})),r=!0})),e.abrupt("return",r);case 7:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}]),a}(Gn),er=function(e){Object(c["a"])(a,e);var t=Object(l["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.apply(this,arguments),e.initiating=!0,e}return Object(s["a"])(a,[{key:"editorWidth",get:function(){return this.isMobile?"98vw":"70vw"}},{key:"computedDiscussionId",get:function(){return this.wrappedHoleOrId instanceof de?this.wrappedHoleOrId.holeId:this.wrappedHoleOrId}},{key:"colClass",get:function(){return this.isMobile?"px-1 py-1":"px-1 py-2"}},{key:"getFloorsUntil",value:function(){var e=Object(P["a"])(regeneratorRuntime.mark((function e(t){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:a=0;case 1:if(!(a<this.request.loadedLength)){e.next=7;break}if(this.floors[a].floorId!==t){e.next=4;break}return e.abrupt("return",a);case 4:a++,e.next=1;break;case 7:if(!this.loading.hasNext){e.next=13;break}return e.next=10,this.loading.load();case 10:return e.next=12,this.getFloorsUntil(t);case 12:return e.abrupt("return",e.sent);case 13:return e.abrupt("return",-1);case 14:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getAndScrollToFloor",value:function(){var e=Object(P["a"])(regeneratorRuntime.mark((function e(t){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(-1===t){e.next=5;break}return e.next=3,this.getFloorsUntil(t);case 3:a=e.sent,Et(a);case 5:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"loadPrefetched",value:function(){var e=Object(P["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!(this.request.loadedLength<this.floors.length&&this.loading.hasNext)){e.next=5;break}return e.next=3,this.loading.load();case 3:e.next=0;break;case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"init",value:function(){var e=Object(P["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.request=new Zn(this.hole.markedFloors,this.computedDiscussionId,this.renderFloor),this.floors=this.request.datas,this.initiating=!1,e.next=5,this.$nextTick();case 5:return e.next=7,this.getAndScrollToFloor(t);case 7:return e.next=9,this.loadPrefetched();case 9:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"mounted",value:function(){var e=Object(P["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!(this.wrappedHoleOrId instanceof de)){e.next=4;break}this.hole=this.wrappedHoleOrId,e.next=6;break;case 4:return e.next=6,this.getHole(this.wrappedHoleOrId);case 6:return e.next=8,this.init(this.displayFloorId);case 8:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"updated",value:function(){yt.a.highlightAll()}}]),a}(qn);Object(u["a"])([Object(v["c"])({required:!0})],er.prototype,"wrappedHoleOrId",void 0),er=Object(u["a"])([Object(v["a"])({components:{Mention:Ct,Loading:Cn,Editor:Mn,FloorCard:ut}})],er);var tr=er,ar=tr,nr=(a("3839"),a("169a")),rr=Object(T["a"])(ar,hn,pn,!1,null,"2f97efb9",null),ir=rr.exports;ne()(rr,{VBtn:Ne["a"],VCard:it["a"],VCardActions:ot["a"],VCardText:ot["c"],VCardTitle:ot["d"],VChip:re["a"],VCol:Ya["a"],VContainer:Ka["a"],VDialog:nr["a"],VDivider:Nt["a"],VForm:la["a"],VIcon:Be["a"],VRow:pa["a"],VSpacer:xt["a"]});var or=function(e){Object(c["a"])(a,e);var t=Object(l["a"])(a);function a(){return Object(o["a"])(this,a),t.apply(this,arguments)}return Object(s["a"])(a,[{key:"computedDiscussionId",get:function(){return parseInt(this.$route.params.id)}},{key:"mentionFloorId",get:function(){return this.$route.query.mention&&"string"===typeof this.$route.query.mention?parseInt(this.$route.query.mention):-1}}]),a}(Wa);or=Object(u["a"])([Object(v["a"])({components:{FloorList:ir}})],or);var sr=or,cr=sr,lr=(a("3c12"),Object(T["a"])(cr,un,dn,!1,null,"549d0190",null)),ur=lr.exports;ne()(lr,{VCol:Ya["a"],VContainer:Ka["a"],VRow:pa["a"]});var dr=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{staticClass:"pa-0 max-height max-width"},[e.isMobile?a("HoleListMobile",{ref:"holeComp"}):a("HolePanel",{ref:"holeComp",on:{"show-floor-list-changed":e.onShowFloatBtnChanged}}),a("div",{directives:[{name:"show",rawName:"v-show",value:e.showFloatBtn,expression:"showFloatBtn"}],staticClass:"float-btn"},[a("v-btn",{attrs:{fab:"",color:"secondary"},on:{mousedown:function(e){e.preventDefault()},click:e.reload}},[a("v-icon",[e._v("mdi-autorenew")])],1),a("br"),a("v-dialog",{attrs:{"content-class":"my-n4 mx-3",persistent:"","max-width":e.editorWidth},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,r=t.attrs;return[a("v-btn",e._g(e._b({attrs:{fab:"",color:"secondary"},on:{mousedown:function(e){e.preventDefault()},click:e.openDialog}},"v-btn",r,!1),n),[a("v-icon",[e._v("mdi-message-plus")])],1)]}}]),model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("v-card",[a("v-card-title",[a("span",{staticClass:"headline"},[e._v("发表树洞")])]),a("v-card-text",[a("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[a("v-combobox",{attrs:{items:e.divisions,"item-text":"name",label:"分区","hide-selected":""},model:{value:e.selectedDivision,callback:function(t){e.selectedDivision=t},expression:"selectedDivision"}}),a("v-combobox",{attrs:{items:e.tags,"item-text":"name","item-value":"name",label:"标签",hint:"回车新增标签",rules:e.tagRules,"error-messages":e.errorMsg["tags"],counter:5,"hide-selected":"",clearable:"",multiple:""},scopedSlots:e._u([{key:"selection",fn:function(t){return[a("v-chip",e._b({key:JSON.stringify(t.item),attrs:{"input-value":t.selected,disabled:t.disabled,outlined:"",color:"red",small:""},on:{"click:close":function(e){return t.parent.selectItem(t.item)}}},"v-chip",t.attrs,!1),[e._v(" "+e._s(t.item.name)+" "),a("span",{staticClass:"tag-icon"},[a("v-icon",{attrs:{"x-small":""}},[e._v("mdi-fire")])],1),a("span",[e._v(" "+e._s(t.item.temperature)+" ")])])]}},{key:"item",fn:function(t){return[a("v-list-item-content",[a("span",{class:"red--text"},[e._v(" "+e._s(t.item.name)+" "),a("v-icon",{staticClass:"tag-icon",attrs:{color:"red",small:""}},[e._v("mdi-fire")]),a("span",{staticClass:"tag-count"},[e._v(" "+e._s(t.item.temperature)+" ")])],1)])]}}]),model:{value:e.selectedTags,callback:function(t){e.selectedTags=t},expression:"selectedTags"}}),a("editor",{ref:"editor",attrs:{contentName:e.contentName},on:{error:e.editorError}})],1)],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"primary",text:""},on:{click:e.closeDialog}},[e._v(" 关闭")]),a("v-btn",{attrs:{color:"primary",text:"",disabled:!e.valid},on:{click:e.addHole}},[e._v(" 发送 ")])],1)],1)],1)],1)],1)},hr=[],pr=a("53ca"),vr=(a("498a"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("double-column-panel",{ref:"doubleColumnPanel",on:{"show-second-col-changed":e.showFloorListChanged},scopedSlots:e._u([{key:"first",fn:function(){return[a("HoleList",{ref:"holeList",attrs:{activate:e.openHole,"display-hole-id":e.displayHoleId,"fix-card-height":!0},on:{refresh:e.refresh}})]},proxy:!0},{key:"second",fn:function(){return[-1!==e.displayHoleId&&e.showFloorList?a("FloorList",{key:e.displayHoleId,ref:"floorList",staticClass:"pa-0",attrs:{"display-floor-id":e.displayFloorId,"wrapped-hole-or-id":e.displayHole}}):e._e()]},proxy:!0}])})}),fr=[],mr=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{staticClass:"pa-0",attrs:{id:"holeList"}},[a("animated-list",{ref:"animatedHoleList",attrs:{datas:e.holes,vkey:"holeIdStr"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.data,r=t.index;return[a("v-col",{staticClass:"py-2 px-1"},[a("HoleCard",{attrs:{hole:n,index:r,activate:e.activate,"is-active":n.holeId===e.displayHoleId,"fix-height":e.fixCardHeight,pinned:r<e.request.pinCount}})],1)]}}])}),a("v-row",[a("v-col",[a("loading",{ref:"loading",attrs:{request:[e.getHoles],"pause-loading":e.pauseLoading}})],1)],1)],1)},gr=[],br=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-card",{staticClass:"rounded",class:e.isActive?"hole-card--active":"hole-card",attrs:{id:"#"+e.hole.holeId}},[a("v-card-text",{staticClass:"d-flex pb-0 pt-2 pl-3 pr-3 font-weight-medium"},[a("span",{staticClass:"flex-left"},e._l(e.hole.tags,(function(e,t){return a("tag-chip",{key:t,attrs:{tag:e}})})),1),e.pinned?a("span",{staticClass:"flex-right"},[a("v-icon",[e._v("mdi-pin")])],1):e._e()]),e.hole.isFolded?a("v-card-text",{staticClass:"folded-hint",attrs:{color:"grey"}},[e._v(" 该内容已折叠： "),a("span",{staticClass:"clickable",on:{click:function(t){e.hole.styleData.displayIt=!e.hole.styleData.displayIt}}},[e._v(" "+e._s(e.hole.styleData.displayIt?"收起":"展开")+" ")])]):e._e(),e.hole.styleData.displayIt?a("div",{staticClass:"post-content"},[a("v-card-text",{directives:[{name:"ripple",rawName:"v-ripple"}],staticClass:"text--primary py-2 text-body-1 clickable",on:{click:function(t){return e.activate(e.hole)}}},[e.hole.styleData.fold?a("div",{staticClass:"fold",style:e.fixHeight?"max-height: "+e.fixedHeight+";":"",attrs:{id:"p"+e.index}},[e._v(" "+e._s(e._f("plainText")(e.hole.firstFloor.content))+" ")]):a("div",{staticClass:"unfold",style:e.fixHeight?"max-height: "+e.fixedHeight+";":"",attrs:{id:"p"+e.index}},[a("div",{staticClass:"rich-text",domProps:{innerHTML:e._s(e.hole.firstFloor.html)}})])]),e.hole.styleData.lines>3&&e.isMobile?a("div",[e.hole.styleData.fold?a("div",[a("v-btn",{attrs:{text:"",block:"",depressed:"","x-small":"",color:"grey lighten-1"},on:{click:function(t){return e.unfold()}}},[a("v-icon",[e._v("mdi-chevron-double-down")])],1)],1):a("div",[a("v-btn",{attrs:{text:"",block:"",depressed:"","x-small":"",color:"grey lighten-1"},on:{click:function(t){return e.fold()}}},[a("v-icon",[e._v("mdi-chevron-double-up")])],1)],1)]):a("div",[a("div",{staticStyle:{height:"0.5rem"}})]),e.hole.firstFloor.floorId!==e.hole.lastFloor.floorId?a("v-card-text",{directives:[{name:"ripple",rawName:"v-ripple"}],staticClass:"clickable",on:{click:function(t){return e.activate(e.hole,e.hole.lastFloor.floorId,!0)}}},[a("v-row",{staticClass:"mx-0"},[a("span",{staticStyle:{width:"100%",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap",color:"rgba(19,13,10,0.83)"}},[e._v(" RE："+e._s(e._f("wordLimit")(e._f("plainText")(e.hole.lastFloor.content)))+" ")])])],1):e._e(),a("v-card-actions",{staticClass:"pt-0 pb-0 caption"},[a("span",[e._v("#"+e._s(e.hole.holeId))]),a("v-spacer"),a("span",[e._v(e._s(e._f("timeDifference")(e.hole.timeUpdated)))]),a("v-spacer"),a("span",[a("v-icon",{attrs:{small:""}},[e._v("mdi-message-processing-outline")]),e._v(" "+e._s(e.hole.reply)+" ")],1)],1)],1):e._e()],1)},yr=[],kr=function(e){Object(c["a"])(a,e);var t=Object(l["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.apply(this,arguments),e.fixedHeight="4.5rem",e}return Object(s["a"])(a,[{key:"calculateFixHeight",value:function(){var e=document.getElementById("p"+this.index);e&&(this.fixedHeight=window.getComputedStyle(e).height)}},{key:"onFixHeightChanged",value:function(){this.calculateFixHeight()}},{key:"mounted",value:function(){this.calculateFixHeight()}},{key:"unfold",value:function(){this.hole.styleData.fold=!1}},{key:"fold",value:function(){this.hole.styleData.fold=!0}}]),a}(F);Object(u["a"])([Object(v["c"])({required:!0})],kr.prototype,"hole",void 0),Object(u["a"])([Object(v["c"])({required:!0,type:Number})],kr.prototype,"index",void 0),Object(u["a"])([Object(v["c"])({required:!0,type:Function})],kr.prototype,"activate",void 0),Object(u["a"])([Object(v["c"])({required:!1,type:Boolean,default:!1})],kr.prototype,"isActive",void 0),Object(u["a"])([Object(v["c"])({type:Boolean,default:!1})],kr.prototype,"fixHeight",void 0),Object(u["a"])([Object(v["c"])({type:Boolean,default:!1})],kr.prototype,"pinned",void 0),Object(u["a"])([Object(v["e"])("fixHeight")],kr.prototype,"onFixHeightChanged",null),kr=Object(u["a"])([Object(v["a"])({components:{TagChip:oe}})],kr);var wr=kr,Or=wr,xr=(a("d619"),a("5607")),jr=Object(T["a"])(Or,br,yr,!1,null,"24b63ab2",null),Cr=jr.exports;ne()(jr,{VBtn:Ne["a"],VCard:it["a"],VCardActions:ot["a"],VCardText:ot["c"],VIcon:Be["a"],VRow:pa["a"],VSpacer:xt["a"]}),On()(jr,{Ripple:xr["a"]});var _r=function(e){Object(c["a"])(a,e);var t=Object(l["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.apply(this,arguments),e.holes=[],e.startTime=new Date,e.collectionIds=[],e.lineHeight=10,e.pauseLoading=!0,e}return Object(s["a"])(a,[{key:"refresh",value:function(){this.request.clear(),this.holes=this.request.datas,this.loading.continueLoad(),this.pin()}},{key:"isPinned",value:function(e){for(var t=0;t<this.request.pinCount;t++)if(this.holes[t].holeId===e)return!0;return!1}},{key:"calculateLines",value:function(){for(var e=0;e<this.holes.length;e++){var t,a=document.getElementById("p"+e),n=null!==(t=null===a||void 0===a?void 0:a.scrollHeight)&&void 0!==t?t:0;this.holes[e].styleData.lines=n/this.lineHeight}}},{key:"getHoles",value:function(){var e=Object(P["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=!1,e.prev=1,e.next=4,this.request.request();case 4:t=e.sent,e.next=11;break;case 7:e.prev=7,e.t0=e["catch"](1),console.log(e.t0),void 0===e.t0.response?this.messageError(JSON.stringify(e.t0)):this.messageError(e.t0.response.data.message);case 11:return e.abrupt("return",t);case 12:case"end":return e.stop()}}),e,this,[[1,7]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"onGotoMentionFloor",value:function(e,t){}},{key:"holesChanged",value:function(){var e=this;setTimeout((function(){var t=document.getElementById("p1");e.lineHeight=t?parseInt(window.getComputedStyle(t,null).getPropertyValue("line-height")):10,e.calculateLines()}),100)}},{key:"mounted",value:function(){var e=this;window.addEventListener("resize",(function(){e.debouncedCalculateLines()})),I.$on("goto-mention-floor",this.onGotoMentionFloor)}},{key:"destroyed",value:function(){me.collection.unregisterUpdateHoleArray(this.$route.name),I.$off("goto-mention-floor",this.onGotoMentionFloor)}},{key:"divisionId",get:function(){return this.route.includes("division")?parseInt(this.$route.params.id):1}},{key:"getDivisionById",value:function(e){var t=null;return me.divisions.forEach((function(a){a.divisionId===e&&(t=a)})),t}},{key:"pin",value:function(){var e=this.getDivisionById(this.divisionId);if(e&&(this.request instanceof Xn||this.request instanceof Yn))for(var t=e.pinned.length-1;t>=0;t--)this.request.pin(new de(e.pinned[t]))}},{key:"onPreloaded",value:function(){var e=Object(P["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.pin(),this.pauseLoading=!1,e.next=4,this.$nextTick();case 4:this.loading.continueLoad();case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"created",value:function(){this.route=this.$route.path,me.collection.getCollections(),this.debouncedCalculateLines=Object(za["a"])(this.calculateLines,300),this.route.includes("home")?this.request=new Xn:this.route.includes("collections")?this.request=new Kn:this.route.includes("division")&&(this.request=new Yn(this.divisionId)),this.holes=this.request.datas,me.collection.registerUpdateHoleArray(this.route,this.holes)}},{key:"filtedTagMapChanged",value:function(){this.request.tag=this.filtedTagMap[this.route]?this.filtedTagMap[this.route]:null,this.$emit("refresh")}}]),a}(F);Object(u["a"])([Object(v["d"])()],_r.prototype,"loading",void 0),Object(u["a"])([Object(v["e"])("holes")],_r.prototype,"holesChanged",null),Object(u["a"])([Object(v["e"])("filtedTagMap",{deep:!0})],_r.prototype,"filtedTagMapChanged",null),_r=Object(u["a"])([v["a"]],_r);var Ir,$r,Sr=_r,Rr=Sr,Er=Object(T["a"])(Rr,Ir,$r,!1,null,null,null),Vr=Er.exports,Tr=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{staticClass:"pa-0 mb-3"},e._l(e.computedDatas,(function(t,n){return a("v-row",{key:t.data[e.vkey],class:t.class,attrs:{id:"animated-"+t.data[e.vkey]}},[e._t("default",null,{data:t.data,index:n})],2)})),1)},Mr=[],Fr=a("1209"),Dr=function(e){Object(c["a"])(a,e);var t=Object(l["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.apply(this,arguments),e.computedDatas=[],e.intermediateDatas=[],e.animating=!1,e.animatingCount=0,e.completeCount=0,e.computedHeight=new Map,e.currentTop=new Map,e.updatedTop=new Map,e}return Object(s["a"])(a,[{key:"generateComputedData",value:function(){var e=[];return this.intermediateDatas.forEach((function(t){e.push({data:t,class:""})})),e}},{key:"measureHeight",value:function(){var e=this;this.computedDatas.forEach((function(t){var a=document.getElementById("animated-"+t.data[e.vkey]);if(a){var n=parseInt(window.getComputedStyle(a).height);e.computedHeight.set(t.data[e.vkey],n)}}))}},{key:"measureCurrentTop",value:function(){var e=this,t=0;this.currentTop=new Map,this.computedDatas.forEach((function(a){e.currentTop.set(a.data[e.vkey],t);var n=e.computedHeight.get(a.data[e.vkey]);if(!n)throw new Error("Computed Height Not Found!");t+=n}))}},{key:"measureUpdatedTop",value:function(){var e=this,t=0;this.updatedTop=new Map,this.intermediateDatas.forEach((function(a){e.updatedTop.set(a[e.vkey],t);var n=e.computedHeight.get(a[e.vkey]);if(!n)throw new Error("Computed Height Not Found!");t+=n}))}},{key:"getComputedDatasFromKey",value:function(e){var t=this,a=null;return this.computedDatas.forEach((function(n){n.data[t.vkey]===e&&(a=n)})),a}},{key:"waitForAnimatingFinish",value:function(){var e=Object(P["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!(this.animating&&t>0)){e.next=5;break}return e.next=3,z(500);case 3:return e.next=5,this.waitForAnimatingFinish(t-1);case 5:this.animating&&console.error("Animating Not Finished!");case 6:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"finishAnimation",value:function(){this.animating=!1,this.updateData()}},{key:"complete",value:function(){this.completeCount++,this.completeCount===this.animatingCount&&(this.computedDatas=this.generateComputedData(),this.finishAnimation())}},{key:"isDataUpToDate",value:function(){if(this.intermediateDatas.length!==this.datas.length)return!1;for(var e=0;e<this.intermediateDatas.length&&e<this.datas.length;e++)if(this.intermediateDatas[e]!==this.datas[e])return!1;return!0}},{key:"updateData",value:function(){this.isDataUpToDate()||(this.intermediateDatas=this.datas.map((function(e){return e})))}},{key:"datasChanged",value:function(){this.animating||this.updateData()}},{key:"intermediateDatasChanged",value:function(){var e=Object(P["a"])(regeneratorRuntime.mark((function e(){var t,a,n=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.intermediateDatas&&0!==this.intermediateDatas.length){e.next=3;break}return this.computedDatas=[],e.abrupt("return");case 3:t=!0,a=0;case 5:if(!(a<this.computedDatas.length)){e.next=12;break}if(this.intermediateDatas[a]&&this.computedDatas[a].data===this.intermediateDatas[a]){e.next=9;break}return t=!1,e.abrupt("break",12);case 9:a++,e.next=5;break;case 12:return this.intermediateDatas.forEach((function(e){null===n.getComputedDatasFromKey(e[n.vkey])&&n.computedDatas.push({data:e,class:"invisible"})})),e.next=15,this.$nextTick();case 15:this.measureHeight(),this.measureCurrentTop(),this.measureUpdatedTop(),this.completeCount=0,this.computedDatas.length>0&&(this.animating=!0,this.animatingCount=this.computedDatas.length),this.computedDatas.forEach((function(e){var a=n.currentTop.get(e.data[n.vkey]),r=n.updatedTop.get(e.data[n.vkey]);if(void 0===a)throw new Error("Cannot Get From Data!");if(void 0!==r){var i=Fr["a"].timeline({targets:document.getElementById("animated-"+e.data[n.vkey])});t||i.add({translateY:r-a,duration:900}),"invisible"===e.class&&i.add({translateX:-100,duration:0}),i.add({translateX:0,opacity:1,duration:550,easing:"cubicBezier(0.385, 0.900, 0.570, 1.010)"},"+=50"),i.finished.then((function(){n.complete();var t=document.getElementById("animated-"+e.data[n.vkey]);t&&(Fr["a"].remove(t),t.removeAttribute("style"))}))}else Object(Fr["a"])({targets:document.getElementById("animated-"+e.data[n.vkey]),opacity:0,translateX:100,duration:550,easing:"cubicBezier(0.385, 0.900, 0.570, 1.010)"}).finished.then((function(){n.complete()}))}));case 21:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}]),a}(F);Object(u["a"])([Object(v["c"])({required:!0,type:Array})],Dr.prototype,"datas",void 0),Object(u["a"])([Object(v["c"])({required:!0,type:String})],Dr.prototype,"vkey",void 0),Object(u["a"])([Object(v["e"])("datas")],Dr.prototype,"datasChanged",null),Object(u["a"])([Object(v["e"])("intermediateDatas",{immediate:!0})],Dr.prototype,"intermediateDatasChanged",null),Dr=Object(u["a"])([v["a"]],Dr);var Hr=Dr,Lr=Hr,Ar=Object(T["a"])(Lr,Tr,Mr,!1,null,null,null),Pr=Ar.exports;ne()(Ar,{VContainer:Ka["a"],VRow:pa["a"]});var qr=function(e){Object(c["a"])(a,e);var t=Object(l["a"])(a);function a(){return Object(o["a"])(this,a),t.apply(this,arguments)}return Object(s["a"])(a,[{key:"getHeight",value:function(){var e=document.getElementById("holeList");return e?parseInt(window.getComputedStyle(e).height):0}},{key:"onGotoMentionFloor",value:function(e,t){var a,n;this.isPinned(e.holeId)?this.openNewOrExistHole(t.holeId,t.floorId):(this.holes.forEach((function(t,r){t.holeId===e.holeId&&(a=t,n=r)})),void 0!==a&&void 0!==n?this.openNewOrExistHole(t.holeId,t.floorId,n):console.error("Current Hole Not Found!"))}},{key:"openNewOrExistHole",value:function(){var e=Object(P["a"])(regeneratorRuntime.mark((function e(t,a){var n,r,i,o,s=this,c=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=c.length>2&&void 0!==c[2]?c[2]:this.request.pinCount,e.next=3,this.loading.waitForUnpause(8);case 3:if(r="number"===typeof t?t:t.holeId,this.holes.forEach((function(e,t){e.holeId===r&&(i=e,o=t)})),void 0!==i&&void 0!==o){e.next=16;break}if("number"===typeof t){e.next=11;break}i=t,this.holes.splice(n,0,i),e.next=14;break;case 11:return e.next=13,this.loading.loadCustomRequestOnce(Object(P["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",s.request.requestHole(r,n));case 1:case"end":return e.stop()}}),e)}))));case 13:i=this.holes[n];case 14:e.next=17;break;case 16:this.isPinned(r)||o===n||(this.holes.splice(o,1),this.holes.splice(o>n?n:n-1,0,i));case 17:return a?this.activate(i,a,!0):this.activate(i),e.next=20,this.animatedHoleList.waitForAnimatingFinish(8);case 20:I.$emit("scroll-to-hole",r);case 21:case"end":return e.stop()}}),e,this)})));function t(t,a){return e.apply(this,arguments)}return t}()},{key:"mounted",value:function(){I.$on("goto-hole",this.openNewOrExistHole)}},{key:"destroyed",value:function(){I.$off("goto-hole",this.openNewOrExistHole)}}]),a}(Vr);Object(u["a"])([Object(v["c"])({required:!0,type:Function})],qr.prototype,"activate",void 0),Object(u["a"])([Object(v["c"])({required:!1,type:Number,default:-1})],qr.prototype,"displayHoleId",void 0),Object(u["a"])([Object(v["c"])({type:Boolean,default:!1})],qr.prototype,"fixCardHeight",void 0),Object(u["a"])([Object(v["d"])()],qr.prototype,"animatedHoleList",void 0),qr=Object(u["a"])([Object(v["a"])({components:{HoleCard:Cr,Loading:Cn,AnimatedList:Pr}})],qr);var Nr=qr,Br=Nr,Ur=Object(T["a"])(Br,mr,gr,!1,null,null,null),Wr=Ur.exports;ne()(Ur,{VCol:Ya["a"],VContainer:Ka["a"],VRow:pa["a"]});var zr=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-sheet",{staticStyle:{height:"100%"}},[a("v-container",{staticClass:"pa-0 double-column-panel"},[a("v-row",{staticClass:"ma-0 max-height",attrs:{justify:"center"}},[a("v-col",{staticClass:"col-first",class:e.firstColClass,on:{transitionend:e.onActivationEnd}},[a("div",{staticStyle:{display:"block",height:"100%",width:"100%"},attrs:{id:"divColFirst"}},[a("div",{staticStyle:{padding:"12px 20px"}},[e._t("first")],2)])]),a("v-col",{staticClass:"col-second",attrs:{cols:"6"}},[a("div",{staticStyle:{display:"block",height:"100%",width:"100%"},attrs:{id:"divColSecond"}},[a("div",{staticStyle:{padding:"12px 20px"}},[e._t("second")],2)])])],1)],1)],1)},Gr=[],Jr=a("dbe5"),Xr=a.n(Jr),Yr=function(e){Object(c["a"])(a,e);var t=Object(l["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.apply(this,arguments),e.firstColActiveClass="col-first--active",e.firstColInactiveClass="col-first--inactive",e.isActive=!1,e.isEnd=!0,e.viewport=0,e.osOptions={className:"os-theme-dark",resize:"none",sizeAutoCapable:!0,clipAlways:!0,normalizeRTL:!0,paddingAbsolute:!1,autoUpdate:null,autoUpdateInterval:33,updateOnLoad:["img"],nativeScrollbarsOverlaid:{showNativeScrollbars:!1,initialize:!0},overflowBehavior:{x:"v-h",y:"scroll"},scrollbars:{visibility:"auto",autoHide:"leave",autoHideDelay:400,dragScrolling:!0,clickScrolling:!1,touchSupport:!0,snapHandle:!1},textarea:{dynWidth:!1,dynHeight:!1,inheritedAttrs:["style","class"]},callbacks:{onInitialized:null,onInitializationWithdrawn:null,onDestroyed:null,onScrollStart:null,onScroll:null,onScrollStop:null,onOverflowChanged:null,onOverflowAmountChanged:null,onDirectionChanged:null,onContentSizeChanged:null,onHostSizeChanged:null,onUpdated:null}},e}return Object(s["a"])(a,[{key:"firstColClass",get:function(){return this.isActive?this.firstColActiveClass:this.firstColInactiveClass}},{key:"showSecondCol",get:function(){return this.isActive&&this.isEnd}},{key:"changeActiveStatus",value:function(){this.isEnd=!1,this.isActive=!this.isActive}},{key:"deactivate",value:function(){this.isActive&&this.changeActiveStatus()}},{key:"activate",value:function(){this.isActive||this.changeActiveStatus()}},{key:"onActivationEnd",value:function(e){"transform"===e.propertyName&&(this.isEnd=!0,this.isActive&&(document.body.scrollTop=document.documentElement.scrollTop=0))}},{key:"scrollToHole",value:function(e){var t=document.getElementById("#".concat(e));t?this.osColFirst?this.osColFirst.scroll(t,1e3):console.error("OverlayScrollbar has no instance!"):console.error("Not Found Element with Id: #".concat(e,"!"))}},{key:"scrollToFloor",value:function(e){var t=document.getElementById(e.toString());t?this.osColSecond?this.osColSecond.scroll(t,1300):console.error("OverlayScrollbar has no instance!"):console.error("Not Found Element with Id: ".concat(e,"!"))}},{key:"mounted",value:function(){var e=this;this.viewport=window.innerHeight,window.addEventListener("resize",(function(){e.viewport=window.innerHeight}));var t=document.getElementById("divColFirst"),a=document.getElementById("divColSecond");this.osColFirst=Xr()(t,this.osOptions),this.osColSecond=Xr()(a,this.osOptions),I.$on("scroll-to-floor",this.scrollToFloor),I.$on("scroll-to-hole",this.scrollToHole)}},{key:"destroyed",value:function(){I.$off("scroll-to-floor",this.scrollToFloor),I.$off("scroll-to-hole",this.scrollToHole)}},{key:"showSecondColChanged",value:function(){var e=Object(P["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()}]),a}(n["default"]);Object(u["a"])([Object(v["e"])("showSecondCol"),Object(v["b"])()],Yr.prototype,"showSecondColChanged",null),Yr=Object(u["a"])([v["a"]],Yr);var Kr=Yr,Qr=Kr,Zr=(a("a416"),Object(T["a"])(Qr,zr,Gr,!1,null,"18e841fa",null)),ei=Zr.exports;ne()(Zr,{VCol:Ya["a"],VContainer:Ka["a"],VRow:pa["a"],VSheet:$e["a"]});var ti=function(e){Object(c["a"])(a,e);var t=Object(l["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.apply(this,arguments),e.displayHoleId=-1,e.isLoadingVisible=!1,e.displayHole=null,e.displayFloorId=-1,e.showFloorList=!1,e}return Object(s["a"])(a,[{key:"refresh",value:function(){this.deactivate(),this.holeList.refresh()}},{key:"openHole",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.displayHole=e,t?(this.displayFloorId=t,this.showFloorList&&a&&this.displayHoleId===e.holeId&&this.floorList.getAndScrollToFloor(t)):this.displayFloorId=-1,a&&this.displayHoleId===e.holeId||this.activate(e.holeId)}},{key:"activate",value:function(e){e===this.displayHoleId?(this.doubleColumnPanel.deactivate(),this.displayHoleId=-1):(this.doubleColumnPanel.activate(),this.displayHoleId=e,document.body.scrollTop=document.documentElement.scrollTop=0)}},{key:"deactivate",value:function(){this.displayHoleId=-1,this.doubleColumnPanel.deactivate()}},{key:"showFloorListChanged",value:function(e){this.showFloorList=e}}]),a}(F);Object(u["a"])([Object(v["d"])()],ti.prototype,"holeList",void 0),Object(u["a"])([Object(v["d"])()],ti.prototype,"floorList",void 0),Object(u["a"])([Object(v["d"])()],ti.prototype,"doubleColumnPanel",void 0),Object(u["a"])([Object(v["b"])()],ti.prototype,"showFloorListChanged",null),ti=Object(u["a"])([Object(v["a"])({components:{DoubleColumnPanel:ei,FloorList:ir,HoleList:Wr}})],ti);var ai=ti,ni=ai,ri=Object(T["a"])(ni,vr,fr,!1,null,null,null),ii=ri.exports,oi=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{staticClass:"pa-0"},[e._l(e.holes,(function(t,n){return a("v-row",{key:n,staticClass:"ma-0",attrs:{justify:"center"}},[a("v-col",{staticClass:"py-1 px-1",attrs:{cols:"12",md:"9"}},[a("HoleCard",{attrs:{hole:t,index:n,activate:e.toDiscussion},on:{refresh:e.refresh}})],1)],1)})),a("loading",{ref:"loading",attrs:{request:[e.getHoles],"pause-loading":e.pauseLoading}})],2)},si=[],ci=function(e){Object(c["a"])(a,e);var t=Object(l["a"])(a);function a(){return Object(o["a"])(this,a),t.apply(this,arguments)}return Object(s["a"])(a,[{key:"toDiscussion",value:function(e,t){var a=this;setTimeout((function(){t?a.$router.push({path:"/hole/".concat(e.holeId),query:{mention:t.toString()}}):a.$router.push({path:"/hole/".concat(e.holeId)})}),50)}},{key:"onGotoMentionFloor",value:function(e,t){this.$router.push({path:"/hole/".concat(t.holeId),query:{mention:t.floorId.toString()}})}}]),a}(Vr);ci=Object(u["a"])([Object(v["a"])({components:{HoleCard:Cr,Loading:Cn}})],ci);var li=ci,ui=li,di=Object(T["a"])(ui,oi,si,!1,null,null,null),hi=di.exports;ne()(di,{VCol:Ya["a"],VContainer:Ka["a"],VRow:pa["a"]});var pi=function(e){Object(c["a"])(a,e);var t=Object(l["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.apply(this,arguments),e.content="",e.tags=[],e.selectedTags=[],e.selectedDivision={divisionId:0,description:"",name:"",pinned:[]},e.dialog=!1,e.tagRules=[function(e){return e.length<=5||"标签不能多于5个"}],e.contentRules=[function(e){return!!e.trim()||"内容不能为空"}],e.errorMsg={},e.valid=!0,e.params={},e.showFloatBtn=!0,e}return Object(s["a"])(a,[{key:"divisions",get:function(){return me.divisions}},{key:"editorWidth",get:function(){return this.isMobile?"98vw":"70vw"}},{key:"contentName",get:function(){return"home-content"}},{key:"reload",value:function(){var e;this.clearTag(null!==(e=this.$route.name)&&void 0!==e?e:void 0),this.holeComp.refresh()}},{key:"editorError",value:function(e){this.messageError(e)}},{key:"openDialog",value:function(){var e=this;this.getTags(),this.selectedDivision=me.divisions[0],me.divisions.forEach((function(t){t.divisionId.toString()===e.$route.params.id&&(e.selectedDivision=t)}))}},{key:"closeDialog",value:function(){this.dialog=!1,this.errorMsg={},this.valid=!0}},{key:"addHole",value:function(){var e=Object(P["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!this.form.validate()||!this.editor.validate()){e.next=15;break}return this.closeDialog(),e.prev=2,e.next=5,this.$axios.post("/holes",{content:this.editor.getContent(),division_id:this.selectedDivision.divisionId,tags:this.selectedTags.map((function(e){return{name:e.name}}))});case 5:this.messageSuccess("发送成功"),this.holeComp.refresh(),this.editor.setContent(""),this.selectedTags=[],e.next=15;break;case 11:e.prev=11,e.t0=e["catch"](2),console.log(e.t0.response),this.messageError(e.t0.response.data.message);case 15:case"end":return e.stop()}}),e,this,[[2,11]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"getTags",value:function(){var e=Object(P["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.$axios.get("/tags");case 3:t=e.sent,this.tags=t.data,e.next=11;break;case 7:e.prev=7,e.t0=e["catch"](0),console.log(e.t0),this.messageError(e.t0.response.data.message);case 11:case"end":return e.stop()}}),e,this,[[0,7]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"mounted",value:function(){var e=this;this.$nextTick((function(){e.checkDevice()})),window.addEventListener("resize",(function(){e.checkDevice()}))}},{key:"destroyed",value:function(){window.removeEventListener("resize",this.checkDevice)}},{key:"onShowFloatBtnChanged",value:function(e){this.showFloatBtn=!e}},{key:"selectedTagsChanged",value:function(){for(var e=this,t=0;t<this.selectedTags.length;t++)if("object"!==Object(pr["a"])(this.selectedTags[t])){var a=function(){var a=e.selectedTags[t].name.trim();return a.length>8?(e.errorMsg.tags="标签不能超过8个字符",e.selectedTags.pop(),"break"):e.tags.find((function(e){return e.name.toLowerCase()===a.toLowerCase()}))?(e.errorMsg.tags="标签不能重复",e.selectedTags.pop(),"break"):0===a.length?(e.errorMsg.tags="标签不能为空",e.selectedTags.pop(),"break"):(e.errorMsg.tags="",void(e.selectedTags[t]={name:a,temperature:0,tagId:-1}))}();if("break"===a)break}}}]),a}(Wa);Object(u["a"])([Object(v["d"])()],pi.prototype,"holeComp",void 0),Object(u["a"])([Object(v["d"])()],pi.prototype,"editor",void 0),Object(u["a"])([Object(v["d"])()],pi.prototype,"form",void 0),Object(u["a"])([Object(v["e"])("selectedTags")],pi.prototype,"selectedTagsChanged",null),pi=Object(u["a"])([Object(v["a"])({components:{Editor:Mn,HolePanel:ii,HoleListMobile:hi}})],pi);var vi=pi,fi=vi,mi=(a("c913"),a("2b5d")),gi=Object(T["a"])(fi,dr,hr,!1,null,"ea0608a4",null),bi=gi.exports;ne()(gi,{VBtn:Ne["a"],VCard:it["a"],VCardActions:ot["a"],VCardText:ot["c"],VCardTitle:ot["d"],VChip:re["a"],VCombobox:mi["a"],VContainer:Ka["a"],VDialog:nr["a"],VForm:la["a"],VIcon:Be["a"],VListItemContent:Ut["a"],VSpacer:xt["a"]});var yi=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-card",[a("v-card-title",[e._v("FDU Hole")]),a("v-card-text",[e._v(" Made with ❤ by "),a("a",{attrs:{href:"https://github.com/fduhole",target:"_blank"}},[e._v("FDUHole-Dev")])]),a("v-card-text",[e._v(" 使用 FDU Hole 意味着你同意 "),a("router-link",{attrs:{to:"/license"}},[e._v(" 相关协议 ")])],1)],1),a("v-card",[a("v-card-title",[e._v("版本信息")]),e.installed?e._e():a("v-card-text",[e._v(" 您正在使用网页版 FDU Hole，请"),a("span",[e._v("安装本应用")]),e._v("以获得更好的体验！ ")]),a("v-card-text",[e._v(" 当前版本："+e._s(e.$feConfig.feVersion)),a("br"),e._v(" 最新版本："+e._s(e.latestVersion)+" "),a("br"),e._v(" "+e._s(e.updateMsg[e.updateMsgIndex])+" ")])],1),a("v-card",[a("v-card-title",[e._v("联系我们")]),a("v-card-subtitle",[e._v("项目首页")]),a("v-card-text",[a("a",{attrs:{href:e.$feConfig.feRepository}},[e._v(e._s(e.$feConfig.feRepository))])]),a("v-card-subtitle",[e._v("团队首页")]),a("v-card-text",[a("a",{attrs:{href:e.$feConfig.teamHomepage}},[e._v(e._s(e.$feConfig.teamHomepage))])]),a("v-card-subtitle",[e._v("团队邮箱")]),a("v-card-text",[a("a",{attrs:{href:"mailto:"+e.$feConfig.teamMail}},[e._v(" "+e._s(e.$feConfig.teamMail)+" ")])])],1),a("v-card",[a("v-card-title",[e._v("友情链接")]),a("v-card-text",[a("ul",e._l(e.$feConfig.friendLinks,(function(t,n){return a("li",{key:n},[a("a",{attrs:{href:t.link}},[e._v(e._s(t.author)+": "+e._s(t.siteName))])])})),0)])],1),a("v-card",[a("v-card-title",[a("a",{attrs:{href:"/report.html"}},[e._v(" 查看构建报告 ")])])],1)],1)},ki=[],wi=(a("1276"),function(e){Object(c["a"])(a,e);var t=Object(l["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.apply(this,arguments),e.latestVersion="正在获取",e.installed=window.matchMedia("(display-mode: standalone)").matches,e.updateMsg=["您正在使用开发版，如遇 BUG 请前往 GitHub 提交 Issue 或 Pull Request！","检测到新版本，重载应用以升级！","您正在使用最新版的FDU Hole！"],e.updateMsgIndex=2,e}return Object(s["a"])(a,[{key:"updateUpdateMsgIndex",value:function(){var e=this.$feConfig.feVersion.split("."),t=this.latestVersion.split(".");return t[0]<e[0]||t[1]<e[1]||t[2]<e[2]?0:t[0]>e[0]||t[1]>e[1]||t[2]>e[2]?1:2}},{key:"getLatestVersion",value:function(){var e=Object(P["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.$axios.request({url:this.$feConfig.latestReleasePkgJSON,transformRequest:[function(e,t){return delete t.Authorization,e}]});case 3:t=e.sent,this.latestVersion=t.data.version,this.updateMsgIndex=this.updateUpdateMsgIndex(),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),this.latestVersion="获取失败 "+e.t0.message;case 11:case"end":return e.stop()}}),e,this,[[0,8]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"mounted",value:function(){this.getLatestVersion()}}]),a}(Wa));wi=Object(u["a"])([v["a"]],wi);var Oi=wi,xi=Oi,ji=(a("f2a3"),Object(T["a"])(xi,yi,ki,!1,null,"3af17152",null)),Ci=ji.exports;ne()(ji,{VCard:it["a"],VCardSubtitle:ot["b"],VCardText:ot["c"],VCardTitle:ot["d"],VContainer:Ka["a"]});var _i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.searchStr?a("search-floor-list",{key:e.searchStr,attrs:{"search-str":e.searchStr}}):e._e()},Ii=[],$i=(a("841c"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("transition-group",{attrs:{name:"slide-fade"}},e._l(e.floors,(function(t,n){return a("v-row",{directives:[{name:"viewer",rawName:"v-viewer"}],key:""+n,attrs:{justify:"center",align:"start"}},[a("v-col",{class:e.colClass,attrs:{lg:"6",md:"8",cols:"12"}},[a("v-card",{attrs:{id:n}},[a("v-card-text",{staticClass:"pb-1 pt-2 text-body-2"},[a("p",[e._v(" "+e._s(t.anonyname)+" "),a("span",{staticStyle:{float:"right"}},[e._v(" "+e._s(e._f("timeDifference")(t.timeUpdated))+" ")])])]),a("v-card-text",{directives:[{name:"ripple",rawName:"v-ripple"}],staticClass:"py-0 clickable",on:{click:function(a){return e.gotoHole(t.holeId,t.floorId)}}},[a("div",{staticClass:"floor-body markdown-body rich-text text--primary ma-0 text-body-1",attrs:{index:n},domProps:{innerHTML:e._s(t.html)}})]),a("v-card-text",{staticClass:"d-flex text-body-2 pb-2"},[a("span",{staticClass:"clickable",on:{click:function(a){return e.gotoHole(t.holeId,t.floorId)}}},[e._v("#"+e._s(t.floorId))]),a("v-spacer"),a("span",{staticClass:"clickable",on:{click:function(a){return e.gotoHole(t.holeId)}}},[e._v("From #"+e._s(t.holeId))])],1)],1)],1)],1)})),1),a("loading",{ref:"loading",attrs:{request:[],"pause-loading":e.initiating}})],1)}),Si=[],Ri=function(e){Object(c["a"])(a,e);var t=Object(l["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.apply(this,arguments),e.floors=[],e.initiating=!0,e}return Object(s["a"])(a,[{key:"colClass",get:function(){return this.isMobile?"px-1 py-1":"px-1 py-2"}},{key:"mounted",value:function(){var e=Object(P["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.request=new Qn(this.searchStr),this.floors=this.request.datas,e.prev=2,e.next=5,this.request.request();case 5:this.initiating=!1,e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](2),void 0===e.t0.response?this.messageError(JSON.stringify(e.t0)):this.messageError(e.t0.response.data.message);case 11:case"end":return e.stop()}}),e,this,[[2,8]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"updated",value:function(){yt.a.highlightAll()}},{key:"gotoHole",value:function(e,t){Dt(e,t)}}]),a}(F);Object(u["a"])([Object(v["c"])({required:!0})],Ri.prototype,"searchStr",void 0),Ri=Object(u["a"])([Object(v["a"])({components:{Mention:Ct,Loading:Cn,Editor:Mn}})],Ri);var Ei=Ri,Vi=Ei,Ti=(a("5ef4"),Object(T["a"])(Vi,$i,Si,!1,null,"78b9d65a",null)),Mi=Ti.exports;ne()(Ti,{VCard:it["a"],VCardText:ot["c"],VCol:Ya["a"],VContainer:Ka["a"],VRow:pa["a"],VSpacer:xt["a"]}),On()(Ti,{Ripple:xr["a"]});var Fi=function(e){Object(c["a"])(a,e);var t=Object(l["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.apply(this,arguments),e.searchStr="",e}return Object(s["a"])(a,[{key:"search",value:function(e){this.searchStr=e}},{key:"mounted",value:function(){this.$route.query.wd&&"string"===typeof this.$route.query.wd&&(this.searchStr=this.$route.query.wd),I.$on("search",this.search)}},{key:"destroyed",value:function(){I.$off("search",this.search)}}]),a}(Wa);Fi=Object(u["a"])([Object(je["b"])({components:{SearchFloorList:Mi}})],Fi);var Di=Fi,Hi=Di,Li=Object(T["a"])(Hi,_i,Ii,!1,null,null,null),Ai=Li.exports,Pi=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{staticClass:"license"},[a("div",[a("p",[e._v("使用 FDU Hole 意味着你同意以下协议。")]),a("p",[e._v(" 如果您不同意以下协议，请立即删除该应用，关闭此网站，停止使用 FDU Hole 提供的的服务。 ")])]),a("v-expansion-panels",e._l(e.licenses,(function(t,n){return a("v-expansion-panel",{key:n},[a("v-expansion-panel-header",[e._v(" "+e._s(t.name)+" ")]),a("v-expansion-panel-content",{staticStyle:{overflow:"auto"}},["pdf"===t.type?a("div",e._l(t.numPages,(function(e){return a("pdf",{key:e,attrs:{src:t.loadingTask,page:e}})})),1):a("div",{staticClass:"license-view",domProps:{innerHTML:e._s(t.content)}})])],1)})),1)],1)},qi=[],Ni=(a("9911"),a("858e")),Bi=function(e){Object(c["a"])(a,e);var t=Object(l["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.apply(this,arguments),e.licenses=[],e}return Object(s["a"])(a,[{key:"created",value:function(){var e=Object(P["a"])(regeneratorRuntime.mark((function e(){var t,a,n,r,i,o,s,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t=Object(p["a"])(this.$feConfig.licenses),e.prev=1,t.s();case 3:if((a=t.n()).done){e.next=23;break}if(n=a.value,"pdf"!==n.type){e.next=14;break}return r=Ni["a"].createLoadingTask(n.link),e.next=9,r.promise;case 9:i=e.sent,o=i.numPages,this.licenses.push(Object(A["a"])(Object(A["a"])({},n),{},{loadingTask:r,numPages:o})),e.next=21;break;case 14:return e.next=16,fetch(n.link);case 16:return s=e.sent,e.next=19,s.text();case 19:c=e.sent,this.licenses.push(Object(A["a"])(Object(A["a"])({},n),{},{content:ce()(Y(c))}));case 21:e.next=3;break;case 23:e.next=28;break;case 25:e.prev=25,e.t0=e["catch"](1),t.e(e.t0);case 28:return e.prev=28,t.f(),e.finish(28);case 31:case"end":return e.stop()}}),e,this,[[1,25,28,31]])})));function t(){return e.apply(this,arguments)}return t}()}]),a}(Wa);Bi=Object(u["a"])([Object(v["a"])({components:{pdf:Ni["a"]}})],Bi);var Ui=Bi,Wi=Ui,zi=(a("6e68"),a("cd55")),Gi=a("49e2"),Ji=a("c865"),Xi=a("0393"),Yi=Object(T["a"])(Wi,Pi,qi,!1,null,"3ed4248c",null),Ki=Yi.exports;ne()(Yi,{VContainer:Ka["a"],VExpansionPanel:zi["a"],VExpansionPanelContent:Gi["a"],VExpansionPanelHeader:Ji["a"],VExpansionPanels:Xi["a"]});var Qi=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.profile?a("v-container",[a("h1",[e._v("注册时间："+e._s(e.joinedTimeDisplayMsg))]),e.profile.isAdmin?a("h1",[e._v("您当前为管理员身份")]):e._e(),a("v-row",{staticStyle:{margin:"20px 0",width:"100%"},attrs:{justify:"space-around"}},[a("v-btn",{attrs:{color:"primary",width:"40%"},on:{click:e.changePassWd}},[e._v(" 修改密码 ")]),a("v-btn",{attrs:{color:"error",width:"40%"},on:{click:e.logout}},[e._v("退出登录")])],1)],1):e._e()},Zi=[],eo=function(e){Object(c["a"])(a,e);var t=Object(l["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.apply(this,arguments),e.profile=null,e}return Object(s["a"])(a,[{key:"getUserInfo",value:function(){var e;this.profile=me.userProfile,this.joinedTimeDisplayMsg=G(null===(e=me.userProfile)||void 0===e?void 0:e.joinedTime)}},{key:"logout",value:function(){Ia.clear(),me.clear(),this.$router.push("/login")}},{key:"changePassWd",value:function(){this.$router.push("/changepassword")}},{key:"onPreloaded",value:function(){this.getUserInfo()}}]),a}(Wa);eo=Object(u["a"])([Object(v["a"])({components:{DiscussionCard:Cr}})],eo);var to=eo,ao=to,no=Object(T["a"])(ao,Qi,Zi,!1,null,null,null),ro=no.exports;ne()(no,{VBtn:Ne["a"],VContainer:Ka["a"],VRow:pa["a"]});var io=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{attrs:{"fill-height":""}},[a("v-row",{attrs:{align:"center",justify:"center"}},[a("v-col",{staticClass:"text-center",attrs:{cols:"12",sm:"8",md:"6",lg:"4"}},[a("v-card",{staticClass:"py-8",attrs:{elevation:"4"}},[a("div",{staticClass:"text-h4 pb-2"},[e._v("重置密码")]),a("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[a("v-alert",{staticClass:"my-4",attrs:{transition:"slide-y-transition",type:e.alertType,value:e.isAlert}},[e._v(" "+e._s(e.alertMsg)+" ")]),a("div",{staticClass:"pl-7 pr-10"},[a("v-row",{staticStyle:{"margin-bottom":"-12px"},attrs:{align:"center",justify:"center"}},[a("v-col",{attrs:{cols:"6",sm:"8"}},[a("v-text-field",{attrs:{label:"邮件验证码","prepend-icon":"mdi-email-check","error-messages":e.errorMsg["code"],clearable:!e.valid,counter:6,rules:e.codeRules},model:{value:e.code,callback:function(t){e.code=t},expression:"code"}})],1),a("v-col",{attrs:{cols:"6",sm:"4"}},[a("v-btn",{attrs:{color:"primary",block:"",disabled:!e.sendValid},on:{click:e.sendCode}},[e._v(" "+e._s(e.sendButton)+" ")])],1)],1),a("v-text-field",{attrs:{label:"密码",type:"password","prepend-icon":"mdi-lock",clearable:!e.valid,counter:32,rules:e.passwordRules},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}}),a("v-text-field",{attrs:{label:"重复密码",type:"password","prepend-icon":"mdi-lock","error-messages":e.errorMsg["password"],clearable:!e.valid,counter:32,rules:e.passwordRules},model:{value:e.password2,callback:function(t){e.password2=t},expression:"password2"}})],1),a("div",{staticClass:"px-10"},[a("v-btn",{staticClass:"my-4",attrs:{color:"success",block:"",disabled:!e.valid},on:{click:e.changepassword}},[e._v(" 修改 ")])],1)],1)],1)],1)],1)],1)},oo=[],so=function(e){Object(c["a"])(a,e);var t=Object(l["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.apply(this,arguments),e.password="",e.password2="",e.code="",e.sendButton="发送验证码",e.sendValid=!0,e.valid=!0,e.isAlert=!1,e.alertMsg="",e.alertType="info",e.errorMsg={email:"",password:""},e.codeRules=[function(e){return!!e||"内容不能为空"},function(e){return/^[0-9]{6}$/.test(e)||"验证码格式不对"}],e.passwordRules=[function(e){return!!e||"内容不能为空"},function(e){return e.length<=32||"密码不能超过32字符"},function(e){return e.length>=8||"密码不能少于8字符"}],e}return Object(s["a"])(a,[{key:"checkPassword",value:function(){this.password!==this.password2?this.errorMsg.password="两次输入不一致":this.errorMsg.password=""}},{key:"sendCode",value:function(){var e=Object(P["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.sendButtonChangeStatus(),this.messageInfo("验证码已发送, 请检查邮件以继续"),e.next=4,this.$axios.get("/verify/email",{params:{email:Ia.email}});case 4:t=e.sent,"邮箱不在白名单内！"===t.data.message?this.messageError(t.data.message):this.messageSuccess(t.data.message);case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"sendButtonChangeStatus",value:function(){var e=this;this.sendValid=!1;for(var t=function(t){setTimeout((function(){e.sendButton=t.toString(),"0"===e.sendButton&&(e.sendButton="发送验证码",e.sendValid=!0)}),1e3*(60-t))},a=60;a>=0;a--)t(a)}},{key:"changepassword",value:function(){var e=Object(P["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!this.form.validate()){e.next=14;break}return e.prev=1,e.next=4,this.$axios.put("/register",{email:Ia.email,password:this.password,verification:parseInt(this.code)});case 4:return this.messageSuccess("修改密码成功！"),e.next=7,z(1e3);case 7:return e.next=9,this.$router.replace("/division/1");case 9:e.next=14;break;case 11:e.prev=11,e.t0=e["catch"](1),this.messageError(e.t0.response.data.message);case 14:case"end":return e.stop()}}),e,this,[[1,11]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"password2Changed",value:function(){this.debouncedCheckPassword()}},{key:"created",value:function(){this.debouncedCheckPassword=Object(za["a"])(this.checkPassword,500)}}]),a}(Wa);Object(u["a"])([Object(v["d"])()],so.prototype,"form",void 0),Object(u["a"])([Object(v["e"])("password2")],so.prototype,"password2Changed",null),so=Object(u["a"])([v["a"]],so);var co=so,lo=co,uo=Object(T["a"])(lo,io,oo,!1,null,null,null),ho=uo.exports;ne()(uo,{VAlert:on["a"],VBtn:Ne["a"],VCard:it["a"],VCol:Ya["a"],VContainer:Ka["a"],VForm:la["a"],VRow:pa["a"],VTextField:va["a"]});var po=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{attrs:{"fill-height":""}},[a("v-row",{attrs:{align:"center",justify:"center"}},[a("v-col",{staticClass:"text-center",attrs:{cols:"12",sm:"8",md:"6",lg:"4"}},[a("v-card",{staticClass:"py-8",attrs:{elevation:"4"}},[a("div",{staticClass:"text-h4 pb-2"},[e._v("重置密码")]),a("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[a("v-alert",{staticClass:"my-4",attrs:{transition:"slide-y-transition",type:e.alertType,value:e.isAlert}},[e._v(" "+e._s(e.alertMsg)+" ")]),a("div",{staticClass:"pl-7 pr-10"},[a("v-text-field",{attrs:{label:"edu邮箱","prepend-icon":"mdi-email","error-messages":e.errorMsg["email"],clearable:!e.valid,counter:32,rules:e.notEmptyRules},model:{value:e.email,callback:function(t){e.email=t},expression:"email"}}),a("v-row",{staticStyle:{"margin-bottom":"-12px"},attrs:{align:"center",justify:"center"}},[a("v-col",{attrs:{cols:"6",sm:"8"}},[a("v-text-field",{attrs:{label:"邮件验证码","prepend-icon":"mdi-email-check","error-messages":e.errorMsg["code"],clearable:!e.valid,counter:6,rules:e.codeRules},model:{value:e.code,callback:function(t){e.code=t},expression:"code"}})],1),a("v-col",{attrs:{cols:"6",sm:"4"}},[a("v-btn",{attrs:{color:"primary",block:"",disabled:!e.sendValid},on:{click:e.sendCode}},[e._v(" "+e._s(e.sendButton)+" ")])],1)],1),a("v-text-field",{attrs:{label:"密码",type:"password","prepend-icon":"mdi-lock",clearable:!e.valid,counter:32,rules:e.passwordRules},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}}),a("v-text-field",{attrs:{label:"重复密码",type:"password","prepend-icon":"mdi-lock","error-messages":e.errorMsg["password"],clearable:!e.valid,counter:32,rules:e.passwordRules},model:{value:e.password2,callback:function(t){e.password2=t},expression:"password2"}})],1),a("div",{staticClass:"px-10"},[a("v-btn",{staticClass:"my-4",attrs:{color:"success",block:"",disabled:!e.valid},on:{click:e.changepassword}},[e._v(" 修改 ")])],1)],1)],1)],1)],1)],1)},vo=[],fo=function(e){Object(c["a"])(a,e);var t=Object(l["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.apply(this,arguments),e.password="",e.password2="",e.email="",e.code="",e.sendButton="发送验证码",e.sendValid=!0,e.valid=!0,e.isAlert=!1,e.alertMsg="",e.alertType="info",e.errorMsg={email:"",password:""},e.notEmptyRules=[function(e){return!!e||"内容不能为空"}],e.codeRules=[function(e){return!!e||"内容不能为空"},function(e){return/^[0-9]{6}$/.test(e)||"验证码格式不对"}],e.passwordRules=[function(e){return!!e||"内容不能为空"},function(e){return e.length<=32||"密码不能超过32字符"},function(e){return e.length>=8||"密码不能少于8字符"}],e}return Object(s["a"])(a,[{key:"checkEmail",value:function(){/^[0-9]{11}@(m\.)?fudan\.edu\.cn$/.test(this.email)?this.errorMsg.email="":this.errorMsg.email="@fudan.edu.cn"}},{key:"checkPassword",value:function(){this.password!==this.password2?this.errorMsg.password="两次输入不一致":this.errorMsg.password=""}},{key:"sendCode",value:function(){var e=Object(P["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.email){e.next=3;break}return this.messageError("用户名与邮箱不能为空"),e.abrupt("return");case 3:return this.sendButtonChangeStatus(),this.messageInfo("验证码已发送, 请检查邮件以继续"),e.prev=5,e.next=8,this.$axios.get("/verify/email",{params:{email:this.email}});case 8:t=e.sent,"邮箱不在白名单内！"===t.data.message?this.messageError(t.data.message):this.messageSuccess(t.data.message),e.next=15;break;case 12:e.prev=12,e.t0=e["catch"](5),this.messageError(e.t0.response.data.message);case 15:case"end":return e.stop()}}),e,this,[[5,12]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"sendButtonChangeStatus",value:function(){var e=this;this.sendValid=!1;for(var t=function(t){setTimeout((function(){e.sendButton=t.toString(),"0"===e.sendButton&&(e.sendButton="发送验证码",e.sendValid=!0)}),1e3*(60-t))},a=60;a>=0;a--)t(a)}},{key:"changepassword",value:function(){var e=Object(P["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!this.form.validate()){e.next=14;break}return e.prev=1,e.next=4,this.$axios.put("/register",{email:this.email,password:this.password,verification:parseInt(this.code)});case 4:return this.messageSuccess("重置密码成功！"),e.next=7,z(1e3);case 7:return e.next=9,this.$router.replace("/login");case 9:e.next=14;break;case 11:e.prev=11,e.t0=e["catch"](1),this.messageError(e.t0.response.data.message);case 14:case"end":return e.stop()}}),e,this,[[1,11]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"emailChanged",value:function(){this.debouncedCheckEmail()}},{key:"password2Changed",value:function(){this.debouncedCheckPassword()}},{key:"created",value:function(){this.debouncedCheckEmail=Object(za["a"])(this.checkEmail,1e3),this.debouncedCheckPassword=Object(za["a"])(this.checkPassword,500)}}]),a}(Wa);Object(u["a"])([Object(v["d"])()],fo.prototype,"form",void 0),Object(u["a"])([Object(v["e"])("email")],fo.prototype,"emailChanged",null),Object(u["a"])([Object(v["e"])("password2")],fo.prototype,"password2Changed",null),fo=Object(u["a"])([v["a"]],fo);var mo=fo,go=mo,bo=Object(T["a"])(go,po,vo,!1,null,null,null),yo=bo.exports;ne()(bo,{VAlert:on["a"],VBtn:Ne["a"],VCard:it["a"],VCol:Ya["a"],VContainer:Ka["a"],VForm:la["a"],VRow:pa["a"],VTextField:va["a"]});var ko=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{staticClass:"pa-0 max-height"},[e.isMobile?a("HoleListMobile"):a("HolePanel")],1)},wo=[],Oo=function(e){Object(c["a"])(a,e);var t=Object(l["a"])(a);function a(){return Object(o["a"])(this,a),t.apply(this,arguments)}return a}(Wa);Oo=Object(u["a"])([Object(v["a"])({components:{HolePanel:ii,HoleListMobile:hi}})],Oo);var xo=Oo,jo=xo,Co=Object(T["a"])(jo,ko,wo,!1,null,"717eed0e",null),_o=Co.exports;ne()(Co,{VContainer:Ka["a"]}),n["default"].use(Da["a"]);var Io=[{path:"/license",meta:{title:"协议"},component:Ki,name:"license"},{path:"/home",redirect:"/division/1"},{path:"/login",meta:{title:"登录"},component:Za,name:"login"},{path:"/division/:id",meta:{title:"分区"},component:bi,name:"division"},{path:"/collections",meta:{title:"收藏"},component:_o,name:"collections"},{path:"/search",meta:{title:"搜索"},component:Ai,name:"search"},{path:"/",redirect:"/division/1"},{path:"/about",meta:{title:"关于"},component:Ci,name:"about"},{path:"/register",meta:{title:"注册"},component:ln,name:"register"},{path:"/changepassword",meta:{title:"修改密码"},component:ho,name:"changepassword"},{path:"/forgetpassword",meta:{title:"重置密码"},component:yo,name:"forgetpassword"},{path:"/hole/:id",meta:{title:"树洞"},component:ur,name:"hole"},{path:"/me",meta:{title:"我的"},component:ro,name:"me"}],$o=new Da["a"]({routes:Io});$o.beforeEach((function(e,t,a){var n;return null!==(n=e.meta)&&void 0!==n&&n.title&&(document.title=e.meta.title),"/login"===e.path||"/forgetpassword"===e.path||"/register"===e.path||"/license"===e.path?a():Ia.token?void a():a("/login")}));var So=$o,Ro=a("bc3a"),Eo=a.n(Ro),Vo=a("2b27"),To=a.n(Vo);function Mo(e){}var Fo=Mo,Do=(a("0808"),a("6944")),Ho=a.n(Do),Lo=a("9224"),Ao="/vue/",Po={feRepository:"https://www.github.com/OpenTreeHole/vue",teamHomepage:"https://www.github.com/OpenTreeHole",teamMail:"fduhole@gmail.com",latestReleasePkgJSON:"https://cdn.jsdelivr.net/gh/fduhole/vue@master/package.json",feVersion:Lo.version,backEndApi:"https://hole.hath.top/",backEndWebsocketApi:"wss://hole.hath.top/ws/notification",licenses:[{name:"社区公约",type:"pdf",link:"".concat(Ao,"licenses/fduhole-norms.pdf")},{name:"使用条款",type:"markdown",link:"".concat(Ao,"licenses/terms-of-use.md")},{name:"隐私政策",type:"markdown",link:"".concat(Ao,"licenses/privacy-policy.md")},{name:"开源协议",type:"markdown",link:"".concat(Ao,"licenses/open-source-licenses.md")}],allowBackRoutes:["discussion","license","search"],banMenuRoutes:["login","register","license","discussion","search"],navItems:[{title:"分区",icon:"mdi-home",route:"/division",group:!0},{title:"收藏",icon:"mdi-star",route:"/collections"},{title:"我的",icon:"mdi-account",route:"/me"},{title:"关于",icon:"mdi-information",route:"/about"}],friendLinks:[{siteName:"旦夕 App",author:"DanXi-Dev",link:"https://danxi-dev.github.io"}]},qo=(a("a753"),a("8096"),a("14e1"),function(){function e(){Object(o["a"])(this,e),this.ws=null,this.unhandledMessages=[]}return Object(s["a"])(e,[{key:"isConnecting",value:function(){return!!this.ws&&this.ws.readyState===WebSocket.CONNECTING}},{key:"isConnected",value:function(){return!!this.ws&&this.ws.readyState===WebSocket.OPEN}},{key:"connect",value:function(){var e=Ia.tokenNoPrefix;if(!e)throw new Error("No Token!");this.ws=new WebSocket("".concat(he.$feConfig.backEndWebsocketApi,"?token=").concat(e)),this.ws.onmessage=this.onMessage,this.ws.onopen=this.onOpen,this.ws.onerror=this.onError,this.ws.onclose=this.onClose}},{key:"send",value:function(e){this.ws?this.ws.send(e):this.unhandledMessages.push(e)}},{key:"sendAction",value:function(e){this.send(JSON.stringify(e))}},{key:"onOpen",value:function(){he.$ws.unhandledMessages.length>0&&(he.$ws.unhandledMessages.forEach((function(e){var t;null===(t=he.$ws.ws)||void 0===t||t.send(e)})),he.$ws.unhandledMessages=[])}},{key:"onError",value:function(){}},{key:"onClose",value:function(){he.$ws.ws=null}},{key:"onMessage",value:function(e){var t="string"===typeof e.data?JSON.parse(e.data):e.data,a=Je(X(t));a&&I.$emit("receive-ws-message",a)}}]),e}()),No=new qo,Bo=a("10a7");n["default"].component("overlay-scrollbars",Bo["a"]),n["default"].prototype.$feConfig=Po,n["default"].prototype.$ws=No,n["default"].config.productionTip=!1,Eo.a.defaults.baseURL=Po.backEndApi,Eo.a.interceptors.request.use((function(e){return e.headers.Authorization=localStorage.getItem("token"),e})),n["default"].prototype.$axios=Eo.a,n["default"].use(To.a),n["default"].use(Fo),n["default"].use(Ho.a),n["default"].filter("plainText",(function(e){return e.replace(/<img.*?>/g,"[图片]").replace(/<.*?>/g," ").replace(/\$+[\s\S]*?\$+/g,"[数学公式]").replace(/##?\d+/g,(function(e){return"[回复"+e+"]"}))})),n["default"].filter("wordLimit",(function(e){var t=document.body.clientWidth<=454?30:40;return e.length>t?e.substring(0,t-4)+" ...":e})),n["default"].filter("timeDifference",J);var Uo=new n["default"]({router:So,vuetify:$t,store:g,render:function(e){return e(Ma)}}).$mount("#app")},d619:function(e,t,a){"use strict";a("e415")},df3f:function(e,t,a){},e1e5:function(e,t,a){},e415:function(e,t,a){},e630:function(e,t,a){"use strict";a("cb0a")},f2a3:function(e,t,a){"use strict";a("8bb9")},fae0:function(e,t,a){"use strict";a("8d2d")}});
//# sourceMappingURL=app.ab24dfba.js.map